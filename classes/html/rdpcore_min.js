var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(v,D,H){v!=Array.prototype&&v!=Object.prototype&&(v[D]=H.value)};$jscomp.getGlobal=function(v){return"undefined"!=typeof window&&window===v?v:"undefined"!=typeof global&&null!=global?global:v};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(v,D,H,L){if(D){H=$jscomp.global;v=v.split(".");for(L=0;L<v.length-1;L++){var N=v[L];N in H||(H[N]={});H=H[N]}v=v[v.length-1];L=H[v];D=D(L);D!=L&&null!=D&&$jscomp.defineProperty(H,v,{configurable:!0,writable:!0,value:D})}};$jscomp.polyfill("Array.prototype.fill",function(v){return v?v:function(v,H,L){var D=this.length||0;0>H&&(H=Math.max(0,D+H));if(null==L||L>D)L=D;L=Number(L);0>L&&(L=Math.max(0,D+L));for(H=Number(H||0);H<L;H++)this[H]=v;return this}},"es6-impl","es3");
var rdpcodecs=rdpcodecs||new function(){function v(){var v=new Uint32Array(10240),z=0,h=new Uint8Array(10240),P=0,y=new Uint8Array(10240),t=0,a=new Uint8Array(10240),p=0,l=new Uint8Array(0),e=0;this.getData=function(){return v};this.getDataSize=function(){return z};this.resetData=function(a){v.length<a&&(v=new Uint32Array(a));z=a;return v};this.resetLumaPlane=function(a){h.length<a&&(h=new Uint8Array(a));P=a;return h};this.getLumaPlanceSize=function(){return P};this.resetOrangeChromaPlane=function(a){y.length<
a&&(y=new Uint8Array(a));t=a;return y};this.getOrangeChromaPlane=function(){return t};this.resetGreenChromaPlane=function(n){a.length<n&&(a=new Uint8Array(n));p=n;return a};this.getGreenChromaPlane=function(){return p};this.resetAlphaPlane=function(a){l.length<a&&(l=new Uint8Array(a));e=a;return l};this.getAlphaPlane=function(){return e}}function D(v,z,h){var P=v,y=h,t=0,a=8,p=z;this.attach=function(l,e,n){P=l;y=n;t=0;a=8;p=e};this.getBits=function(l){for(var e,n=0;t<y&&0<l;)e=l,e>a&&(e=a),0!=n&&
(n<<=e),n|=P[t+p]>>a-e&(1<<e)-1,a-=e,l-=e,0==a&&(a=8,t++);return n};this.putBits=function(l,e){for(var n=e,f;t<y&&0<n;)f=n,f>a&&(f=a),P[t+p]|=(l>>n-f&(1<<f)-1)<<a-f,a-=f,n-=f,0==a&&(a=8,t++)};this.eos=function(){return t>=y};this.left=function(){return t>=y?0:8*(y-t-1)+a};this.getProcessBytes=function(){return 8>a?t+1:t}}function H(){this.y=this.x=this.CrLen=this.CbLen=this.YLen=this.quantIdxCr=this.quantIdxCb=this.quantIdxY=0;this.data=new Uint32Array(4096)}function L(){function v(P,y,t,a,p,l,e){t=
P.et;var n=4096,f=P.bitStream;var d=1;var r=d<<3,u=1,m=u<<3,q=0;for(null==f?f=new D(a,p,l):f.attach(a,p,l);!f.eos()&&0<n;)if(0!=d){for(;!f.eos();){p=f.getBits(1);if(0!=p)break;d=a=1<<d;d>n&&(d=n);0<d&&(na(e,q,q+d,0),q+=d);n-=a;r+=4;80<r&&(r=80);0>r&&(r=0);d=r>>3}d=a=d=f.getBits(d);d>n&&(d=n);0<d&&(na(e,q,q+d,0),q+=d);n-=a;d=f.getBits(1);a=0;do if(p=f.getBits(1),1==p)a++;else break;while(1);p=f.getBits(u);p|=a<<u;0==a?(m+=-2,80<m&&(m=80),0>m&&(m=0),u=m>>3):1!=a&&(m+=a,80<m&&(m=80),0>m&&(m=0),u=m>>
3);a=p+1;0<n&&(e[q++]=0!=d?-a:a);n--;r+=-6;80<r&&(r=80);0>r&&(r=0);d=r>>3}else{a=0;do if(p=f.getBits(1),1==p)a++;else break;while(1);p=f.getBits(u);p|=a<<u;0==a?(m+=-2,80<m&&(m=80),0>m&&(m=0),u=m>>3):1!=a&&(m+=a,80<m&&(m=80),0>m&&(m=0),u=m>>3);a=p;if(1!=t){l=a;for(p=0;0!=l;)l>>=1,p++;p=f.getBits(p);a-=p;0!=p&&0!=a?(r+=-6,80<r&&(r=80),0>r&&(r=0),d=r>>3):0==p&&0==a&&(r+=6,80<r&&(r=80),0>r&&(r=0),d=r>>3);0<n&&(e[q++]=0!=(p&1)?-1*(p+1>>1):p>>1);n--;0<n&&(e[q++]=0!=(a&1)?-1*(a+1>>1):a>>1);n--}else 0==
a?(0<n&&(e[q++]=0),n--,r+=3):(0<n&&(e[q++]=0!=(a&1)?-1*(a+1>>1):a>>1),n--,r+=-3),80<r&&(r=80),0>r&&(r=0),d=r>>3}t=64;n=4032;for(f=4033;1<t;n++,f++,t--)e[f]+=e[n];h(e,0,4096,5);h(e,0,1024,y[8]-6);h(e,1024,1024,y[7]-6);h(e,2048,1024,y[9]-6);h(e,3072,256,y[5]-6);h(e,3328,256,y[4]-6);h(e,3584,256,y[6]-6);h(e,3840,64,y[2]-6);h(e,3904,64,y[1]-6);h(e,3968,64,y[3]-6);h(e,4032,64,y[0]-6);P=P.dwtBuffer;z(e,3840,P,8);z(e,3072,P,16);z(e,0,P,32)}function z(h,y,t,a){var p,l;var e=a<<1;var n=y+a*a*3;var f=y;var d=
0;var r=y+a*a;var u=y+a*a*2;var m=a*a*2;for(p=0;p<a;p++){t[d]=h[n]-(h[f]+h[f]+1>>1)<<16>>16;t[m]=h[r]-(h[u]+h[u]+1>>1)<<16>>16;for(l=1;l<a;l++){var q=l<<1;t[d+q]=h[n+l]-(h[f+l-1]+h[f+l]+1>>1)<<16>>16;t[m+q]=h[r+l]-(h[u+l-1]+h[u+l]+1>>1)<<16>>16}for(l=0;l<a-1;l++)q=l<<1,t[d+q+1]=(h[f+l]<<1)+(t[d+q]+t[d+q+2]>>1)<<16>>16,t[m+q+1]=(h[u+l]<<1)+(t[m+q]+t[m+q+2]>>1)<<16>>16;q=l<<1;t[d+q+1]=(h[f+l]<<1)+t[d+q]<<16>>16;t[m+q+1]=(h[u+l]<<1)+t[m+q]<<16>>16;n+=a;f+=a;d+=e;r+=a;u+=a;m+=e}for(q=0;q<e;q++){for(l=
0;l<a;l++)p=l<<1,d=y+p*e+q,m=l*e+q,f=m+a*e,h[d]=t[m]-((0<l?t[f-e]:t[f])+t[f]+1>>1)<<16>>16;for(l=0;l<a;l++)p=l<<1,d=y+p*e+q,m=l*e+q,f=m+a*e,h[d+e]=(t[f]<<1)+(h[d]+h[d+(l<a-1?2*e:0)]>>1)<<16>>16}}function h(h,y,t,a){if(0!=a)for(;0<t;y++,t--)h[y]<<=a}this.decodeRgb=function(h,y,t,a,p,l,e,n,f,d){v(h,t,p,y.getData(),y.getPosition(),a,h.yrBuffer);y.skipPosition(a);v(h,t,e,y.getData(),y.getPosition(),l,h.cbgBuffer);y.skipPosition(l);v(h,t,f,y.getData(),y.getPosition(),n,h.crbBuffer);y.skipPosition(n);y=
h.yrBuffer;t=h.cbgBuffer;a=h.crbBuffer;for(l=0;4096>l;l++)e=y[l],n=t[l],f=a[l],e=e+4096<<16,p=e+91947*f,f=e-22544*n-46792*f,e+=115998*n,p>>=21,f>>=21,e>>=21,y[l]=0>p?0:255<p?255:p,t[l]=0>f?0:255<f?255:f,a[l]=0>e?0:255<e?255:e;y=h.yrBuffer;t=h.cbgBuffer;h=h.crbBuffer;for(a=0;4096>a;a++)d[a]=4278190080|h[a]<<16|t[a]<<8|y[a]}}function N(v){var z=[new hi5.graphic.Rectangle],h=[new H],P=0,y=0;this.resetRects=function(h){if(z.length<h){var a=z.length;for(z.length=h;a<h;a++)z[a]=new hi5.graphic.Rectangle}P=
h;return z};this.resetTiles=function(t){var a=0;if(v){if(h.length<t)for(a=h.length,h.length=t;a<t;a++)h[a]=new H}else for(;a<t;a++)h[a]=new H;y=t;return h};this.getRectSize=function(){return P};this.getTileSize=function(){return y};this.getRects=function(){return z};this.getTiles=function(){return h}}function Z(){this.ctxId=0;this.tileSize=64;this.qt=this.et=this.xft=this.cct=this.flags=0;this.yrBuffer=new Int32Array(4096);this.cbgBuffer=new Int32Array(4096);this.crbBuffer=new Int32Array(4096);this.dwtBuffer=
new Int32Array(4096);var z=this;this.setProperties=function(v){z.flags=v&7;z.cct=v>>3&3;z.xft=v>>5&15;z.et=v>>9&15};this.bitStream=new D}var z=hi5.Arrays.arraycopy,na=hi5.Arrays.fill;this.flipimage=function(v,D,h,P,y,t){t*=P;for(var a=0;a<y;a++)P=D+(y-a-1)*t,z(v,P,h,a*t,t)};this.Bitmap=function(v,z,h,P,y,t,a,p){this.data=v;this.left=P;this.top=y;this.width=z;this.height=h;this.bitsperpixel=t;this.bytesperpixel=Math.floor((t+7)/8);this.raw=a;this.codec=p||0};this.NSCodec=function(){function D(h,v,
y,t,a){if(0==y)na(t,0,a,255);else if(y<a){var p=a;for(a=0;4<p;){var l=h[v++];5==p?(t[a++]=l,p--):l==h[v]?(v++,255>(h[v]&255)?(y=h[v++]&255,y+=2):(v++,y=(h[v+3]&255)<<24|(h[v+2]&255)<<16|(h[v+1]&255)<<8|h[v]&255,v+=4),na(t,a,a+y,l),a+=y,p-=y):(t[a++]=l,p--)}for(y=0;4>y;y++)t[a++]=h[v++]}else z(h,v,t,0,a)}var H=new v;this.getData=function(){return H.getData()};this.getDataSize=function(){return H.getDataSize()};this.process=function(h,v,y,t){v=h.getLittleEndian32();var a=h.getLittleEndian32(),p=h.getLittleEndian32();
h.skipPosition(4);var l=h.getByte(),e=h.getByte();h.skipPosition(2);var n=h.getData(),f=h.getPosition(),d=H.resetData(y*t),r=y+(~(y&7)+1&7),u=t+(~(t&1)+1&1);var m=r*u;var q=H.resetLumaPlane(m),B=H.resetOrangeChromaPlane(m);m=H.resetGreenChromaPlane(m);var k=y*t,u=0<e?(r>>1)*(u>>1):k,w=0<e?u:k;D(n,f,v,q,0<e?r*t:k);f+=v;D(n,f,a,B,u);D(n,f+a,p,m,w);for(var z,A,x,C,I,n=0,f=y+(~(y&7)+1&7),la=l-1,r=0;r<t;r++)for(0<e?(k=r*f,u=(r>>1)*(f>>1),w=(r>>1)*(f>>1)):(k=r*y,u=r*y,w=r*y),l=0;l<y;l++)z=q[k]&255,A=(B[u]&
255)<<la<<24>>24,x=m[w]<<la<<24>>24,C=z+A-x,I=z+x,z=z-A-x,z=0>z?0:255<z?255:z,I=0>I?0:255<I?255:I,C=0>C?0:255<C?255:C,d[n++]=4278190080|z<<16|I<<8|C,k++,u+=0<e?l%2:1,w+=0<e?l%2:1;h.skipPosition(v+a+p)}};this.RemoteFX=function(v){var z=new N(!v);v=new L;var h=new Z;this.decode=function(y,t){for(var a,p,l=y.getPosition()+t;y.getPosition()<l;){a=y.getLittleEndian16();p=y.getLittleEndian32();if(0==p)break;p=y.getPosition()-6+p;switch(a){case 52416:a=y;a.getLittleEndian32();a.getLittleEndian16();break;
case 52417:y.skipPosition(4);break;case 52418:a=y;for(var e=a.getByte(),n=0;n<e;n++){var f=a.getByte(),d=a.getLittleEndian16(),r=a.getLittleEndian16();svGlobal.logger.info("Channel, id:"+f+" width:"+d+" height:"+r)}break;case 52419:a=y;a.skipPosition(2);h.ctxId=a.getByte();h.tileSize=a.getLittleEndian16();h.setProperties(a.getLittleEndian16());break;case 52420:y.skipPosition(10);break;case 52421:y.skipPosition(2);break;case 52422:a=y;a.skipPosition(2);a.skipPosition(1);e=a.getLittleEndian16();n=z.resetRects(e);
for(f=0;f<e;f++)d=n[f],d.x=a.getLittleEndian16(),d.y=a.getLittleEndian16(),d.width=a.getLittleEndian16(),d.height=a.getLittleEndian16();a.skipPosition(4);break;case 52423:a=y;e=h;a.skipPosition(6);n=a.getLittleEndian16();e.cct=n>>>4&3;e.xft=n>>>6&15;e.et=n>>>10&15;e.qt=n>>>14&3;var u=a.getByte();a.skipPosition(1);f=a.getLittleEndian16();a.skipPosition(4);for(var d=Array(10*u),m=0,n=0;n<u;n++)r=a.getByte(),d[m++]=r&15,d[m++]=r>>>4,r=a.getByte(),d[m++]=r&15,d[m++]=r>>>4,r=a.getByte(),d[m++]=r&15,d[m++]=
r>>>4,r=a.getByte(),d[m++]=r&15,d[m++]=r>>>4,r=a.getByte(),d[m++]=r&15,d[m++]=r>>>4;r=z.resetTiles(f);for(n=0;n<f;n++){var u=r[n],m=a,q=u;m.skipPosition(6);q.quantIdxY=m.getByte();q.quantIdxCb=m.getByte();q.quantIdxCr=m.getByte();q.x=64*m.getLittleEndian16();q.y=64*m.getLittleEndian16();q.YLen=m.getLittleEndian16();q.CbLen=m.getLittleEndian16();q.CrLen=m.getLittleEndian16();P(e,a,d,u.YLen,10*u.quantIdxY,u.CbLen,10*u.quantIdxCb,u.CrLen,10*u.quantIdxCr,u.data)}break;default:svGlobal.logger.warn("unknown blockType 0x%X"+
a)}y.setPosition(p)}return z};var P=v.decodeRgb;this.getResult=function(){return z}};this.RDP8BulkData=function(){function v(d){for(;e<d;)l<<=8,y<t&&(l+=P[y++]),e+=8;p-=d;e-=d;a=l>>e;l&=(1<<e)-1}function z(a,f,k){if(!(0>=k)){if(25E5<k){var q=k-25E5;k=25E5;f+=q;r=(r+q)%25E5}25E5>=r+k?(m(a,f,d,r,k),25E5==(r+=k)&&(r=0)):(q=25E5-r,m(a,f,d,r,q),m(a,f+q,d,0,k-q),r=k-q)}}var h=[[1,0,8,0,0],[5,17,5,1,0],[5,18,7,1,32],[5,19,9,1,160],[5,20,10,1,672],[5,21,12,1,1696],[5,24,0,0,0],[5,25,0,0,1],[6,44,14,1,5792],
[6,45,15,1,22176],[6,52,0,0,2],[6,53,0,0,3],[6,54,0,0,255],[7,92,18,1,54944],[7,93,20,1,317088],[7,110,0,0,4],[7,111,0,0,5],[7,112,0,0,6],[7,113,0,0,7],[7,114,0,0,8],[7,115,0,0,9],[7,116,0,0,10],[7,117,0,0,11],[7,118,0,0,58],[7,119,0,0,59],[7,120,0,0,60],[7,121,0,0,61],[7,122,0,0,62],[7,123,0,0,63],[7,124,0,0,64],[7,125,0,0,128],[8,188,20,1,1365664],[8,189,21,1,2414240],[8,252,0,0,12],[8,253,0,0,56],[8,254,0,0,57],[8,255,0,0,102],[9,380,22,1,4511392],[9,381,23,1,8705696],[9,382,24,1,17094304],[0]],
P=[],y=0,t=0,a=0,p=0,l=0,e=0,n=new Uint8Array(65536),f=0,d=new Uint8Array(25E5),r=0,u=new hi5.DataBuffer(n,0,65536);this.resetHistory=function(){r=a=0};this.release=function(){u=d=n=P=n=null};var m=hi5.Arrays.arraycopy;this.decompress=function(q,B,k){if(1>k)return null;var w=q[B++];k--;f=0;if(w&32)for(P=q,y=B,t=B+k-1,p=8*(k-1)-(P[t]&7),l=e=0;p;)for(q=k=B=0;0!=h[q][0];q++){for(;B<h[q][0];)v(1),k=(k<<1)+a,B++;if(k==h[q][1]){if(0==h[q][3])v(h[q][2]),q=h[q][4]+a,d[r]=q,25E5==++r&&(r=0),n[f++]=q;else{v(h[q][2]);
var Q=h[q][4]+a;if(0!=Q){v(1);if(0==a)q=3;else{q=4;B=2;for(v(1);1==a;)q*=2,B++,v(1);v(B);q+=a}B=n;k=f;var A=k;if(!(0>=q)){w=q;var x=(r+25E5-Q)%25E5;Q=Math.min(w,Q);if(25E5>=x+Q)m(d,x,B,A,Q);else{var C=25E5-x;m(d,x,B,A,C);m(d,0,B,A+C,Q-C)}if(0!=(w-=Q)){A+=Q;x=Q;do Q=x,Q>w&&(Q=w),m(B,k,B,A,Q),A+=Q,x<<=1;while(0<(w-=Q))}}z(n,f,q)}else v(15),q=a,p-=e,l=e=0,m(P,y,n,f,q),z(P,y,q),y+=q,p-=8*q;f+=q}break}}else z(q,B,k),m(q,B,n,0,k),f=k;u.setPosition(0);u.markEnd(f);return u}};this.bitmap=new function(){function v(h,
v,y,t,a,p){for(var l,e=0,n,f,d,r,u=0,m,q=v,B=p;e<t;){p=B+y*t*4-(e+1)*y*4;d=0;m=p;l=0;if(0==u)for(;l<y;){n=h[v++];f=n&15;n=n>>4&15;r=f<<4|n;47>=r&&16<=r&&(f=r,n=0);for(;0<n;)d=h[v++],a[p]=d,p+=4,l++,n--;for(;0<f;)a[p]=d,p+=4,l++,f--}else for(;l<y;){n=h[v++];f=n&15;n=n>>4&15;r=f<<4|n;47>=r&&16<=r&&(f=r,n=0);for(;0<n;)r=h[v++],0!=(r&1)?(r>>=1,r+=1,d=-r):d=r>>=1,r=a[u+4*l]+d,a[p]=r,p+=4,l++,n--;for(;0<f;)r=a[u+4*l]+d,a[p]=r,p+=4,l++,f--}e++;u=m}return v-q}function z(h,v,y,t,a,p){var l,e;for(e=0;e<t;e++)for(l=
0;l<y;l++)a[p+4*((t-e-1)*y+l)]=h[v+(e*y+l)]}this.decompressInt16=function(h,v,y,t,a){var p=-1,l=-1;y=a+y;for(var e,n,f,d=h,r=-1,u,m=0,q=0,B=0,k=4294967295,w,z=!1,A=!1,x=new Uint32Array(h*v);a<y;){u=0;n=t[a++];e=n>>4;switch(e){case 12:case 13:case 14:e-=6;n&=15;f=16;break;case 15:e=n&15;9>e?(n=t[a++],n|=t[a++]<<8):n=11>e?8:1;f=0;break;default:e>>=1,n&=31,f=32}0!=f&&(w=2==e||7==e,0==n?n=w?t[a++]+1:t[a++]+f:w&&(n<<=3));switch(e){case 0:r!=e||d==h&&-1==p||(z=!0);break;case 8:w=t[a++]|t[a++]<<8,m=4278190080|
w>>8&248|w>>13&7|(w>>3&252|w>>9&3)<<8|(w<<3&248|w>>2&7)<<16;case 3:w=t[a++]|t[a++]<<8;q=4278190080|w>>8&248|w>>13&7|(w>>3&252|w>>9&3)<<8|(w<<3&248|w>>2&7)<<16;break;case 6:case 7:w=t[a++]|t[a++]<<8;k=4278190080|w>>8&248|w>>13&7|(w>>3&252|w>>9&3)<<8|(w<<3&248|w>>2&7)<<16;e-=5;break;case 9:B=3;e=2;u=3;break;case 10:B=5,e=2,u=5}r=e;for(f=0;0<n;)switch(d>=h&&(d=0,v--,p=l,l=0+v*h),e){case 0:z&&(x[l+d]=-1==p?k:x[p+d]^k|4278190080,z=!1,n--,d++);if(-1==p){for(;0!=(n&-8)&&d+8<h;)for(var C=0;8>C;C++)x[l+d]=
4278190080,n--,d++;for(;0<n&&d<h;)x[l+d]=4278190080,n--,d++}else{for(;0!=(n&-8)&&d+8<h;)for(C=0;8>C;C++)x[l+d]=x[p+d],n--,d++;for(;0<n&&d<h;)x[l+d]=x[p+d],n--,d++}break;case 1:if(-1==p){for(;0!=(n&-8)&&d+8<h;)for(C=0;8>C;C++)x[l+d]=k,n--,d++;for(;0<n&&d<h;)x[l+d]=k,n--,d++}else{for(;0!=(n&-8)&&d+8<h;)for(C=0;8>C;C++)x[l+d]=x[p+d]^k|4278190080,n--,d++;for(;0<n&&d<h;)x[l+d]=x[p+d]^k|4278190080,n--,d++}break;case 2:if(-1==p){for(;0!=(n&-8)&&d+8<h;)for(C=0;8>C;C++)f<<=1,f&=255,0==f&&(B=0!=u?u&255:t[a++],
f=1),x[l+d]=0!=(B&f)?k:4278190080,n--,d++;for(;0<n&&d<h;)f<<=1,f&=255,0==f&&(B=0!=u?u&255:t[a++],f=1),x[l+d]=0!=(B&f)?k:4278190080,n--,d++}else{for(;0!=(n&-8)&&d+8<h;)for(C=0;8>C;C++)f<<=1,f&=255,0==f&&(B=0!=u?u&255:t[a++],f=1),x[l+d]=0!=(B&f)?x[p+d]^k|4278190080:x[p+d],n--,d++;for(;0<n&&d<h;)f<<=1,f&=255,0==f&&(B=0!=u?u&255:t[a++],f=1),x[l+d]=0!=(B&f)?x[p+d]^k|4278190080:x[p+d],n--,d++}break;case 3:for(;0!=(n&-8)&&d+8<h;)for(C=0;8>C;C++)x[l+d]=q,n--,d++;for(;0<n&&d<h;)x[l+d]=q,n--,d++;break;case 4:for(;0!=
(n&-8)&&d+8<h;)for(C=0;8>C;C++)w=t[a++]|t[a++]<<8,x[l+d]=4278190080|w>>8&248|w>>13&7|(w>>3&252|w>>9&3)<<8|(w<<3&248|w>>2&7)<<16,n--,d++;for(;0<n&&d<h;)w=t[a++]|t[a++]<<8,x[l+d]=4278190080|w>>8&248|w>>13&7|(w>>3&252|w>>9&3)<<8|(w<<3&248|w>>2&7)<<16,n--,d++;break;case 8:for(;0!=(n&-8)&&d+8<h;)for(C=0;8>C;C++)A?(x[l+d]=q,A=!1):(x[l+d]=m,A=!0,n++),n--,d++;for(;0<n&&d<h;)A?(x[l+d]=q,A=!1):(x[l+d]=m,A=!0,n++),n--,d++;break;case 13:for(;0!=(n&-8)&&d+8<h;)for(C=0;8>C;C++)x[l+d]=4294967295,n--,d++;for(;0<
n&&d<h;)x[l+d]=4294967295,n--,d++;break;case 14:for(;0!=(n&-8)&&d+8<h;)for(C=0;8>C;C++)x[l+d]=4278190080,n--,d++;for(;0<n&&d<h;)x[l+d]=4278190080,n--,d++;break;default:n--,d++}}return x};this.byte2int=function(h,v,y){v||(v=h.length);y||(y=0);v=Math.floor(v/4);for(var t=new Uint32Array(v),a,p=0;p<v;p++)a=(p<<2)+y,t[p]=(h[a+3]&255)<<24|h[a+2]&255|(h[a+1]&255)<<8|(h[a+0]&255)<<16;return t};this.decompressInt32=function(h,D,y,t,a){y=t[a];a+=1;var p=h*D,l=new Uint32Array(4*p);if(0==(y&32)){for(var e=a,
n,f,d=0,r,u,m,q=e,B=3;d<D;){n=B+h*D*4-(d+1)*h*4;for(f=0;f<h;){r=t[e++];u=r&15;r=r>>4&15;m=u<<4|r;47>=m&&16<=m&&(u=m,r=0);for(;0<r;)e++,l[n]=255,n+=4,f++,r--;for(;0<u;)l[n]=255,n+=4,f++,u--}d++}a+=e-q}else for(n=0;n<p;n++)e=n<<2,l[e+3]=255;0!=(y&16)?(y=v(t,a,h,D,l,2),a+=y,y=v(t,a,h,D,l,1),v(t,a+y,h,D,l,0)):(z(t,a,h,D,l,2),a+=p,z(t,a,h,D,l,1),z(t,a+p,h,D,l,0));return rdpBitmap.byte2int(l)};this.decompressInt24=function(h,v,y,t,a){var p=-1,l=-1;y=a+y;for(var e,n,f,d=h,r=-1,u,m=0,q=0,B=0,k=4294967295,
w=!1,z=!1,A,x=new Uint32Array(h*v);a<y;){u=0;n=t[a++];e=n>>4;switch(e){case 12:case 13:case 14:e-=6;n&=15;f=16;break;case 15:e=n&15;9>e?(n=t[a++],n|=t[a++]<<8):n=11>e?8:1;f=0;break;default:e>>=1,n&=31,f=32}0!=f&&(A=2==e||7==e,0==n?n=A?t[a++]+1:t[a++]+f:A&&(n<<=3));switch(e){case 0:r!=e||d==h&&-1==p||(w=!0);break;case 8:m=4278190080|t[a++]<<16|t[a++]<<8|t[a++];case 3:q=4278190080|t[a++]<<16|t[a++]<<8|t[a++];break;case 6:case 7:k=4278190080|t[a++]<<16|t[a++]<<8|t[a++];e-=5;break;case 9:B=3;e=2;u=3;
break;case 10:B=5,e=2,u=5}r=e;for(f=0;0<n;)switch(d>=h&&(d=0,v--,p=l,l=0+v*h),e){case 0:w&&(x[l+d]=-1==p?k:x[p+d]^k|4278190080,w=!1,n--,d++);if(-1==p){for(;0!=(n&-8)&&d+8<h;)for(A=0;8>A;A++)x[l+d]=4278190080,n--,d++;for(;0<n&&d<h;)x[l+d]=4278190080,n--,d++}else{for(;0!=(n&-8)&&d+8<h;)for(A=0;8>A;A++)x[l+d]=x[p+d],n--,d++;for(;0<n&&d<h;)x[l+d]=x[p+d],n--,d++}break;case 1:if(-1==p){for(;0!=(n&-8)&&d+8<h;)for(A=0;8>A;A++)x[l+d]=k,n--,d++;for(;0<n&&d<h;)x[l+d]=k,n--,d++}else{for(;0!=(n&-8)&&d+8<h;)for(A=
0;8>A;A++)x[l+d]=x[p+d]^k|4278190080,n--,d++;for(;0<n&&d<h;)x[l+d]=x[p+d]^k|4278190080,n--,d++}break;case 2:if(-1==p){for(;0!=(n&-8)&&d+8<h;)for(A=0;8>A;A++)f<<=1,f&=255,0==f&&(B=0!=u?u&255:t[a++],f=1),x[l+d]=0!=(B&f)?k:4278190080,n--,d++;for(;0<n&&d<h;)f<<=1,f&=255,0==f&&(B=0!=u?u&255:t[a++],f=1),x[l+d]=0!=(B&f)?k:4278190080,n--,d++}else{for(;0!=(n&-8)&&d+8<h;)for(A=0;8>A;A++)f<<=1,f&=255,0==f&&(B=0!=u?u&255:t[a++],f=1),x[l+d]=0!=(B&f)?x[p+d]^k|4278190080:x[p+d],n--,d++;for(;0<n&&d<h;)f<<=1,f&=255,
0==f&&(B=0!=u?u&255:t[a++],f=1),x[l+d]=0!=(B&f)?x[p+d]^k|4278190080:x[p+d],n--,d++}break;case 3:for(;0!=(n&-8)&&d+8<h;)for(A=0;8>A;A++)x[l+d]=q,n--,d++;for(;0<n&&d<h;)x[l+d]=q,n--,d++;break;case 4:for(;0!=(n&-8)&&d+8<h;)for(A=0;8>A;A++)x[l+d]=4278190080|t[a++]<<16|t[a++]<<8|t[a++],n--,d++;for(;0<n&&d<h;)x[l+d]=4278190080|t[a++]<<16|t[a++]<<8|t[a++],n--,d++;break;case 8:for(;0!=(n&-8)&&d+8<h;)for(A=0;8>A;A++)z?(x[l+d]=q,z=!1):(x[l+d]=m,z=!0,n++),n--,d++;for(;0<n&&d<h;)z?(x[l+d]=q,z=!1):(x[l+d]=m,z=
!0,n++),n--,d++;break;case 13:for(;0!=(n&-8)&&d+8<h;)for(A=0;8>A;A++)x[l+d]=4294967295,n--,d++;for(;0<n&&d<h;)x[l+d]=4294967295,n--,d++;break;case 14:for(;0!=(n&-8)&&d+8<h;)for(A=0;8>A;A++)x[l+d]=4278190080,n--,d++;for(;0<n&&d<h;)x[l+d]=4278190080,n--,d++}}return x};this.decompress=function(h,v,z,t,a){var p=-1,l=0;z+=a;var e=h,n=-1,f=0,d=0,r=0,u=4294967295,m=!1,q=!1,B=new Uint8Array(h*v);for(B[0]=0;a<z;){var k=0;var w=t[a++];var y=w>>4;switch(y){case 12:case 13:case 14:y-=6;w&=15;var A=16;break;case 15:y=
w&15;9>y?(w=t[a++],w|=t[a++]<<8):w=11>y?8:1;A=0;break;default:y>>=1,w&=31,A=32}if(0!=A){var x=2==y||7==y;0==w?w=x?t[a++]+1:t[a++]+A:x&&(w<<=3)}switch(y){case 0:n!=y||e==h&&-1==p||(m=!0);break;case 8:f=t[a++];case 3:d=t[a++];break;case 6:case 7:u=t[a++];y-=5;break;case 9:r=3;y=2;k=3;break;case 10:r=5,y=2,k=5}n=y;for(A=0;0<w;)switch(e>=h&&(e=0,v--,p=l,l=0+v*h),y){case 0:m&&(B[l+e]=-1==p?u:B[p+e]^u,m=!1,w--,e++);if(-1==p){for(;0!=(w&-8)&&e+8<h;)for(x=0;8>x;x++)B[l+e]=0,w--,e++;for(;0<w&&e<h;)B[l+e]=
0,w--,e++}else{for(;0!=(w&-8)&&e+8<h;)for(x=0;8>x;x++)B[l+e]=B[p+e],w--,e++;for(;0<w&&e<h;)B[l+e]=B[p+e],w--,e++}break;case 1:if(-1==p){for(;0!=(w&-8)&&e+8<h;)for(x=0;8>x;x++)B[l+e]=u,w--,e++;for(;0<w&&e<h;)B[l+e]=u,w--,e++}else{for(;0!=(w&-8)&&e+8<h;)for(x=0;8>x;x++)B[l+e]=B[p+e]^u,w--,e++;for(;0<w&&e<h;)B[l+e]=B[p+e]^u,w--,e++}break;case 2:if(-1==p){for(;0!=(w&-8)&&e+8<h;)for(x=0;8>x;x++)A<<=1,A&=255,0==A&&(r=0!=k?k:t[a++],A=1),B[l+e]=0!=(r&A)?u:0,w--,e++;for(;0<w&&e<h;)A<<=1,A&=255,0==A&&(r=0!=
k?k:t[a++],A=1),B[l+e]=0!=(r&A)?u:0,w--,e++}else{for(;0!=(w&-8)&&e+8<h;)for(x=0;8>x;x++)A<<=1,A&=255,0==A&&(r=0!=k?k:t[a++],A=1),B[l+e]=0!=(r&A)?B[p+e]^u:B[p+e],w--,e++;for(;0<w&&e<h;)A<<=1,A&=255,0==A&&(r=0!=k?k:t[a++],A=1),B[l+e]=0!=(r&A)?B[p+e]^u:B[p+e],w--,e++}break;case 3:for(;0!=(w&-8)&&e+8<h;)for(x=0;8>x;x++)B[l+e]=d,w--,e++;for(;0<w&&e<h;)B[l+e]=d,w--,e++;break;case 4:for(;0!=(w&-8)&&e+8<h;)for(x=0;8>x;x++)B[l+e]=t[a++],w--,e++;for(;0<w&&e<h;)B[l+e]=t[a++],w--,e++;break;case 8:for(;0!=(w&
-8)&&e+8<h;)for(x=0;8>x;x++)q?(B[l+e]=d,q=!1):(B[l+e]=f,q=!0,w++),w--,e++;for(;0<w&&e<h;)q?(B[l+e]=d,q=!1):(B[l+e]=f,q=!0,w++),w--,e++;break;case 13:for(;0!=(w&-8)&&e+8<h;)for(x=0;8>x;x++)B[l+e]=255,w--,e++;for(;0<w&&e<h;)B[l+e]=255,w--,e++;break;case 14:for(;0!=(w&-8)&&e+8<h;)for(x=0;8>x;x++)B[l+e]=0,w--,e++;for(;0<w&&e<h;)B[l+e]=0,w--,e++;break;default:w--,e++}}return B}}};
function RdpGeneral(v,D,H,L,N,Z,z){function na(c){return"on"==c||"true"==c}function Ca(){var c=0,b=0,a=0,d=0,q=0;this.on=!1;this.verify=function(m,f,k,e){m==c&&f==b&&k==a&&e==d?this.on||(q++,3<q&&(this.on=!0)):(q=0,this.on=!1,c=m,b=f,a=k,d=e)}}function ra(){return va.displayName||va.server||va.symlink||va.id||"undefined"}function h(c){return 4278190080|(c<<3&248|c>>2&7)<<16|(c>>3&252|c>>9&3)<<8|c>>8&248|c>>13&7}function P(c){return 4278190080|ja.paletteRdp[2][c]<<16|ja.paletteRdp[1][c]<<8|ja.paletteRdp[0][c]}
function y(c){return 4278190080|c}function t(c){return 4278190080|c}function a(c,b){switch(c){case 16:Sa=h;Jb=rdpBitmap.decompressInt16;break;case 8:Sa=P;break;case 24:Sa=t;Jb=rdpBitmap.decompressInt24;break;case 32:Sa=y;Jb=rdpBitmap.decompressInt32;break;case 15:return va.invitation||console.log("15 bit color is not supported anymore."),!1;default:return!1}L=c;Kb=(c+7)/8>>0;if(b&&J.onColorChange)J.onColorChange(c);return!0}function p(c,b,a){D=c;H=b;aa=ka=0;da=D-1;ba=H-1;if(J.onresolutionchange&&
a)J.onresolutionchange(c,b)}function l(c){hb||K.send(c)}function e(){this.style=this.yOrigin=this.xOrigin=0;this.pattern=Array(8);this.toStream=function(c){c.setByte(this.xOrigin);c.setByte(this.yOrigin);c.setByte(this.style);c.setBytes(this.pattern)};this.fromStream=function(c){this.xOrigin=c.getByte();this.yOrigin=c.getByte();this.style=c.getByte();this.pattern=c.getBytes(8)};this.byteLength=function(){return 11}}function n(){this.bottom=this.top=this.right=this.left=0;this.toStream=function(c){c.setLittleEndian16(this.left);
c.setLittleEndian16(this.right);c.setLittleEndian16(this.top);c.setLittleEndian16(this.bottom)};this.fromStream=function(c){this.left=c.getLittleEndian16();this.right=c.getLittleEndian16();this.top=c.getLittleEndian16();this.bottom=c.getLittleEndian16()};this.byteLength=function(){return 8}}function f(){this.action=this.offset=this.bottom=this.top=this.right=this.left=0;this.toStream=function(c){c.setLittleEndian16(this.left);c.setLittleEndian16(this.right);c.setLittleEndian16(this.top);c.setLittleEndian16(this.bottom);
c.setLittleEndian32(this.offset);c.setByte(this.action)};this.fromStream=function(c){this.left=c.getLittleEndian16();this.right=c.getLittleEndian16();this.top=c.getLittleEndian16();this.bottom=c.getLittleEndian16();this.offset=c.getLittleEndian32();this.action=c.getByte()};this.byteLength=function(){return 13}}function d(){this.opcode=this.cy=this.cx=this.y=this.x=0;this.toStream=function(c){c.setLittleEndian16(this.x);c.setLittleEndian16(this.y);c.setLittleEndian16(this.cx);c.setLittleEndian16(this.cy);
c.setByte(this.opcode)};this.fromStream=function(c){this.x=c.getLittleEndian16();this.y=c.getLittleEndian16();this.cx=c.getLittleEndian16();this.cy=c.getLittleEndian16();this.opcode=c.getByte()};this.byteLength=function(){return 9}}function r(c,b,a,d,q){this.offset=c;this.baseLine=b;this.width=a;this.height=d;this.fontData=q}function u(){this.opcode=this.backgroundColor=this.endY=this.endX=this.startY=this.startX=this.mixmode=0;this.pen=new B;this.toStream=function(c){c.setLittleEndian16(this.mixmode);
c.setLittleEndian16(this.startX);c.setLittleEndian16(this.startY);c.setLittleEndian16(this.endX);c.setLittleEndian16(this.endY);c.setLittleEndian32(this.backgroundColor);c.setByte(this.opcode);this.pen.toStream(c)};this.fromStream=function(c){this.mixmode=c.getLittleEndian16();this.startX=c.getLittleEndian16();this.startY=c.getLittleEndian16();this.endX=c.getLittleEndian16();this.endY=c.getLittleEndian16();this.backgroundColor=c.getLittleEndian32();this.opcode=c.getByte();this.pen.fromStream(c)};
this.byteLength=function(){return 15+this.pen.byteLength()}}function m(){this.cacheIDX=this.cacheID=this.colorTable=this.srcY=this.srcX=this.opcode=this.cy=this.cx=this.y=this.x=0;this.toStream=function(c){c.setLittleEndian16(this.x);c.setLittleEndian16(this.y);c.setLittleEndian16(this.cx);c.setLittleEndian16(this.cy);c.setByte(this.opcode);c.setLittleEndian16(this.srcX);c.setLittleEndian16(this.srcY);c.setByte(this.cacheID);c.setByte(this.colorTable);c.setLittleEndian16(this.cacheIDX)};this.fromStream=
function(c){this.x=c.getLittleEndian16();this.y=c.getLittleEndian16();this.cx=c.getLittleEndian16();this.cy=c.getLittleEndian16();this.opcode=c.getByte();this.srcX=c.getLittleEndian16();this.srcY=c.getLittleEndian16();this.cacheID=c.getByte();this.colorTable=c.getByte();this.cacheIDX=c.getLittleEndian16()};this.byteLength=function(){return 17}}function q(){this.foregroundColor=this.backgroundColor=this.opcode=this.cy=this.cx=this.y=this.x=0;this.brush=new e;this.toStream=function(c){c.setLittleEndian16(this.x);
c.setLittleEndian16(this.y);c.setLittleEndian16(this.cx);c.setLittleEndian16(this.cy);c.setByte(this.opcode);c.setLittleEndian32(this.backgroundColor);c.setLittleEndian32(this.foregroundColor);this.brush.toStream(c)};this.fromStream=function(c){this.x=c.getLittleEndian16();this.y=c.getLittleEndian16();this.cx=c.getLittleEndian16();this.cy=c.getLittleEndian16();this.opcode=c.getByte();this.backgroundColor=c.getLittleEndian32();this.foregroundColor=c.getLittleEndian32();this.brush.fromStream(c)};this.byteLength=
function(){return 17+this.brush.byteLength()}}function B(){this.color=this.width=this.style=0;this.toStream=function(c){c.setByte(this.style);c.setByte(this.width);c.setLittleEndian32(this.color)};this.fromStream=function(c){this.style=c.getByte();this.width=c.getByte();this.color=c.getLittleEndian32()};this.byteLength=function(){return 6}}function k(){this.dataSize=this.opcode=this.lines=this.foregroundColor=this.flags=this.y=this.x=0;this.data=[];this.toStream=function(c){c.setLittleEndian16(this.x);
c.setLittleEndian16(this.y);c.setByte(this.opcode);c.setLittleEndian32(this.foregroundColor);c.setByte(this.lines);c.setByte(this.dataSize);this.dataSize&&c.setBytes(this.data)};this.fromStream=function(c){this.x=c.getLittleEndian16();this.y=c.getLittleEndian16();this.opcode=c.getByte();this.foregroundColor=c.getLittleEndian32();this.lines=c.getByte();if(this.dataSize=c.getByte())this.data=c.getBytes(this.dataSize)};this.byteLength=function(){return 11+this.dataSize}}function w(){this.color=this.cy=
this.cx=this.y=this.x=0;this.toStream=function(c){c.setLittleEndian16(this.x);c.setLittleEndian16(this.y);c.setLittleEndian16(this.cx);c.setLittleEndian16(this.cy);c.setLittleEndian32(this.color)};this.fromStream=function(c){this.x=c.getLittleEndian16();this.y=c.getLittleEndian16();this.cx=c.getLittleEndian16();this.cy=c.getLittleEndian16();this.color=c.getLittleEndian32()};this.byteLength=function(){return 12}}function Q(){this.srcY=this.srcX=this.opcode=this.cy=this.cx=this.y=this.x=0;this.toStream=
function(c){c.setLittleEndian16(this.x);c.setLittleEndian16(this.y);c.setLittleEndian16(this.cx);c.setLittleEndian16(this.cy);c.setByte(this.opcode);c.setLittleEndian16(this.srcX);c.setLittleEndian16(this.srcY)};this.fromStream=function(c){this.x=c.getLittleEndian16();this.y=c.getLittleEndian16();this.cx=c.getLittleEndian16();this.cy=c.getLittleEndian16();this.opcode=c.getByte();this.srcX=c.getLittleEndian16();this.srcY=c.getLittleEndian16()};this.byteLength=function(){return 13}}function A(){this.length=
this.opcode=this.boxBottom=this.boxRight=this.boxTop=this.boxLeft=this.clipBottom=this.clipRight=this.clipTop=this.clipLeft=this.font=this.unknown=this.y=this.x=this.backgroundColor=this.foregroundColor=this.mixmode=this.flags=0;this.text=null;this.toStream=function(c){c.setByte(this.font);c.setByte(this.flags);c.setByte(this.opcode);c.setByte(this.mixmode);c.setLittleEndian32(this.foregroundColor);c.setLittleEndian32(this.backgroundColor);c.setLittleEndian16(this.clipLeft);c.setLittleEndian16(this.clipTop);
c.setLittleEndian16(this.clipRight);c.setLittleEndian16(this.clipBottom);c.setLittleEndian16(this.boxLeft);c.setLittleEndian16(this.boxTop);c.setLittleEndian16(this.boxRight);c.setLittleEndian16(this.boxBottom);c.setLittleEndian16(this.x);c.setLittleEndian16(this.y);c.setByte(this.length);this.length&&c.setBytes(this.text)};this.fromStream=function(c){this.font=c.getByte();this.flags=c.getByte();this.opcode=c.getByte();this.mixmode=c.getByte();this.foregroundColor=c.getLittleEndian32();this.backgroundColor=
c.getLittleEndian32();this.clipLeft=c.getLittleEndian16();this.clipTop=c.getLittleEndian16();this.clipRight=c.getLittleEndian16();this.clipBottom=c.getLittleEndian16();this.boxLeft=c.getLittleEndian16();this.boxTop=c.getLittleEndian16();this.boxRight=c.getLittleEndian16();this.boxBottom=c.getLittleEndian16();this.x=c.getLittleEndian16();this.y=c.getLittleEndian16();if(this.length=c.getByte())this.text=c.getBytes(this.length)};this.byteLength=function(){return 33+this.length}}function x(){this.orderType=
0;this.bounds=new n;this.destBlt=new d;this.patBlt=new q;this.screenBlt=new Q;this.line=new u;this.rectangle=new w;this.deskSave=new f;this.memBlt=new m;this.polyLine=new k;this.text2=new A;this._line=new hi5.graphic.Line;this.paletteRdp=null;this.toPDU=function(){var c=4+this.bounds.byteLength()+this.destBlt.byteLength()+this.patBlt.byteLength()+this.screenBlt.byteLength()+this.line.byteLength()+this.rectangle.byteLength()+this.deskSave.byteLength()+this.memBlt.byteLength()+this.polyLine.byteLength()+
this.text2.byteLength()+14+10,b=new Uint8Array(c);b[0]=29;b[2]=1;b[3]=3;c=new hi5.DataBuffer(b,0,c);c.skipPosition(4);this.bounds.toStream(c);this.destBlt.toStream(c);this.patBlt.toStream(c);this.screenBlt.toStream(c);this.line.toStream(c);this.rectangle.toStream(c);this.deskSave.toStream(c);this.memBlt.toStream(c);this.polyLine.toStream(c);this.text2.toStream(c);c.setLittleEndian16(ka);c.setLittleEndian16(aa);c.setLittleEndian16(da);c.setLittleEndian16(ba);c.setLittleEndian32(Ga);c.setByte(this.orderType);
c.setByte(L);ab.toStream(c);return b};this.fromStream=function(c){this.bounds.fromStream(c);this.destBlt.fromStream(c);this.patBlt.fromStream(c);this.screenBlt.fromStream(c);this.line.fromStream(c);this.rectangle.fromStream(c);this.deskSave.fromStream(c);this.memBlt.fromStream(c);this.polyLine.fromStream(c);this.text2.fromStream(c);ka=c.getLittleEndian16();aa=c.getLittleEndian16();da=c.getLittleEndian16();ba=c.getLittleEndian16();Ga=c.getLittleEndian32();this.orderType=c.getByte();a(c.getByte(),!0);
ab.fromStream(c)}}function C(){sa=ta=!1;ic();ja=new x;Ga=0;wa&&wa.reset();xa&&xa.reset()}function I(){function c(c){Va=new RecordingManager;Va.setHeader({name:0<c.user.length?c.server+"_"+c.user:c.server,width:D,height:H,color:L,namesuffix:".rdpv",filetag:"RDPV",duration:0})}if(!ta){sa=!1;if(hb)K=hb;else{if(J.oncreatewebsocket)K=J.oncreatewebsocket(v);else{var b=0==J.mode&&z?v.substring(0,v.indexOf("?"))+"?_METHOD=post":v;K=new WebSocket(b,"rdp")}"binaryType"in K&&(K.binaryType="arraybuffer")}svGlobal.logger.info(v);
K.onopen=function(c){ta=!0;if(J.onopen)J.onopen();l("87"+navigator.userAgent)};"on"==va.recording&&c(va);K.onmessage=la;K.onclose=Qb;K.onerror=J.onerror}}function la(c){var a=c.data;if("string"!=typeof a){var d=new Uint8Array(a);null!=Va&&Va.add(new RecordingObj(d,0,a.byteLength,-1));Ha.attach(d,0,a.byteLength);var q=Ha.getLittleEndian16();switch(q){case 29:lb(Ha);break;case 48:if(J.onSlowPath)J.onSlowPath();var m=Ha;m.getLittleEndian16();var f=m.getByte(),k=m.getByte(),e=m.getLittleEndian16(),n=
0!=(k&32);n&&(e-=18);if(n)if(3==(k&15)){var h=m.getByte();var r=m.getByte();e-=2;if(0!=(h&16)&&0!=(r&32)){wa.dec5(m.getData(),m.getPosition(),e,r);var t=wa.getData(),w=wa.getDecompressedLength();xa.dec(t.getData(),t.getPosition(),w,h)}else xa.dec(m.getData(),m.getPosition(),e,h);var B=xa.getData()}else wa.dec(m.getData(),m.getPosition(),e,k),B=wa.getData();else B=m;var u=B;switch(f){case 2:var y=u.getLittleEndian16();switch(y){case 0:u.skipPosition(2);var z=u.getLittleEndian16();u.skipPosition(2);
F(u,z);break;case 1:mb(u);break;case 2:ya(u);break;case 3:break;default:svGlobal.logger.warn("Unimplemented Update type "+y)}break;case 20:break;case 31:bb=!1;break;case 27:var la=u.getLittleEndian16();u.skipPosition(2);switch(la){case 3:var A=u.getLittleEndian16();var C=u.getLittleEndian16();J.onMoveCursor(A,C,!0);break;case 6:Ta(u,24);break;case 7:N.setCursor(u.getLittleEndian16());break;case 1:var I=u.getLittleEndian16();switch(I){case 0:break;default:svGlobal.logger.warn("XXX system pointer message "+
I)}break;case 8:var D=u.getLittleEndian16();Ta(u,D)}break;case 34:break;case 38:a:{var H=u.getLittleEndian32(),G=J.sessionInfo;if(3>H){var Q=J.sessionInfo;switch(H){case 0:u.skipPosition(4);Q.domain=u.getUnicodeString(52,!0);u.skipPosition(4);Q.userName=u.getUnicodeString(512,!0);Q.sessionId=u.getLittleEndian32();break;case 1:Q.version=u.getLittleEndian16();u.skipPosition(4);Q.sessionId=u.getLittleEndian32();var L=u.getLittleEndian32();var W=u.getLittleEndian32();u.skipPosition(558);Q.domain=u.getUnicodeString(L,
!0);Q.userName=u.getUnicodeString(W,!0)}}else if(3==H){u.skipPosition(2);var K=u.getLittleEndian32();u.skipPosition(4);if(2==K)break a;u.getLittleEndian32();u.skipPosition(4);G.sessionId=u.getLittleEndian32();for(var P=u.getBytes(16),ea=Array(16),aa=0;16>aa;aa++)ea[aa]=P[aa]&255;G.random=ea}if(!sa&&J.onloggedin)J.onloggedin(J.sessionInfo);sa=!0;var U="8D";G.sessionId&&(U+=G.sessionId+"\t"+(G.random?hi5.Base64.enc(G.random):0)+"\t"+G.userName+"\t"+G.domain);M||l(U)}bb=!1;break;case 40:J.sendKeyboardSynchronize(na(va.scrollLock),
na(va.numLock),na(va.capsLock));bb=!1;break;case 41:u.skipPosition(2);var ba=u.getLittleEndian16(),R=0!=(ba&4),da=0!=(ba&2),ka=0!=(ba&1),X=0!=(ba&8);if(J.onLockKeyState)J.onLockKeyState({capsLock:R,numLock:da,scrollLock:ka,kanaLock:X});svGlobal.logger.info("LED state, capsLock:"+R+" numLock:"+da+" scrollLock:"+ka+" kanaLock:"+X);break;case 47:bb=!0;var S=u.getLittleEndian32();svGlobal.logger.info("Disconnect:"+S);var pa=11==S&&O;if(pa)J.onCloseSurface();if(!(1>S||pa)){!M&&ta&&l("85"+S);var Z=S.toString(16).toUpperCase();
if(J.onerror)J.onerror(Z)}break;case 50:u.skipPosition(4);break;case 54:var Ra=u.getLittleEndian32().toString(16).toUpperCase();svGlobal.logger.warn("server status code:"+Ra);break;case 55:for(var T=u.getLittleEndian32(),Ba,Ua,E,V,ua=0,ra=0,La=0,fa=0,Ga=0;Ga<T;Ga++)Ba=u.getLittleEndian32(),Ua=u.getLittleEndian32(),E=u.getLittleEndian32(),V=u.getLittleEndian32(),u.skipPosition(4),ua=Math.min(Ba,ua),ra=Math.max(ra,E),La=Math.min(Ua,La),fa=Math.max(fa,V);Ba=ra-ua+1;Ua=fa-La+1;svGlobal.logger.warn("monitor, count:"+
T+" w:"+Ba+" h:"+Ua);p(Ba,Ua,!0);break;default:svGlobal.logger.warn("Unimplemented Data PDU type "+f)}break;case 49:if(J.onFastPath)J.onFastPath();a:{var Wa=Ha,Ia=Wa.getByte(),Sa=Ia&15,Ca=Ia>>4&3,Xa=0;2==(Ia>>6&3)&&(Xa=Wa.getByte());var lc=0!=(Xa&32);var ca=Wa.getLittleEndian16();if(lc)if(3==(Xa&15)){var mc=Wa.getByte();var Xb=Wa.getByte();ca-=2;if(0!=(mc&16)&&0!=(Xb&32)){wa.dec5(Wa.getData(),Wa.getPosition(),ca,Xb);var nb=wa.getData(),ob=wa.getDecompressedLength();xa.dec(nb.getData(),nb.getPosition(),
ob,mc)}else xa.dec(Wa.getData(),Wa.getPosition(),ca,mc);var Ya=xa.getData();ca=xa.getDecompressedLength()}else wa.dec(Wa.getData(),Wa.getPosition(),ca,Xa),Ya=wa.getData(),ca=wa.getDecompressedLength();else Ya=Wa;if(0!=Ca)switch(Ca){case 2:case 3:wb.addFragement(Ya,ca);break a;case 1:wb.addFragement(Ya,ca),Ya=wb.clearFragements()}var qa=Ya;ga&&ga.begin("decodeFastPath");switch(Sa){case 0:var hb=qa.getLittleEndian16();F(qa,hb);break;case 1:qa.skipPosition(2);mb(qa);break;case 2:qa.skipPosition(2);ya(qa);
break;case 3:break;case 4:for(var Ib=qa.getEnd(),jb,cb;qa.getPosition()<Ib;){var Pa=qa.getLittleEndian16();switch(Pa){case 1:case 6:jb=qa.getLittleEndian16();cb=qa.getLittleEndian16();qa.getLittleEndian16();qa.getBigEndian16();var rc=void 0,Da=void 0,Y=qa,pb=jb,sc=cb,Jb=Y.getByte();Y.skipPosition(2);var Mb=Y.getByte(),Ma=Y.getLittleEndian16(),za=Y.getLittleEndian16(),Ea=Y.getLittleEndian32(),Nb=Y.getPosition()+Ea;switch(Mb){case 0:var xb=rdpBitmap.byte2int(Y.getData(),Ea,Y.getPosition()),Da=new Uint32Array(xb.length);
rdpcodecs.flipimage(xb,0,Da,Ma,za,1);N.setRGBs(pb,sc,Ma,za,Da,0,Ma);break;case 1:yb(Y,Jb,Ma,za);var ab=zb.getData(),Ab=zb.getDataSize(),Da=new Uint32Array(Ab);rdpcodecs.flipimage(ab,0,Da,Ma,za,1);N.setRGBs(pb,sc,Ma,za,Da,0,Ma);break;case 3:for(var ha=Na.decode(Y,Ea),kb=ha.getRects(),Bb=ha.getTiles(),Ob=ha.getTileSize(),Cb=ha.getRectSize(),Qa=Cb?new nc(0,0,0,0):null,Rb=0;Rb<Ob;Rb++){var qb=Bb[Rb];if(Cb)for(var Db=0;Db<Cb;Db++)kb[Db].intersection(qb.x,qb.y,64,64,Qa),Qa.isEmpty()||(rc=64*(Qa.y-qb.y)+
(Qa.x-qb.x),Qa.x+=pb,Qa.y+=sc,N.setRGBs(Qa.x,Qa.y,Qa.width,Qa.height,qb.data,rc,64));else N.setRGBs(qb.x,qb.y,64,64,qb.data,0,64)}}Y.setPosition(Nb);break;case 4:var sb=qa,oa=sb.getLittleEndian16(),tb=sb.getLittleEndian32();1==oa&&l("91"+tb);break;default:svGlobal.logger.warn("Invalid surface cmd:"+Pa)}}break;case 5:break;case 6:break;case 8:break;case 9:Ta(qa,24);break;case 10:N.setCursor(qa.getLittleEndian16());break;case 11:var db=qa.getLittleEndian16();Ta(qa,db);break;default:svGlobal.logger.warn("XXX RDP5 opcode "+
Sa)}ga&&ga.end("decodeFastPath")}break;case 65:var Aa=Ha,Sb=Aa.getPosition(),Za=Aa.getByte(),ia=Aa.getByte();seqNoLow=Aa.getByte();seqNoHigh=Aa.getByte();reqType=Aa.getLittleEndian16;out=null;payloadLen=0;payload=null;averageRTT=bandwidth=baseRTT=0;if(0!=ia)svGlobal.logger.warn("invalid msg channel data");else switch(reqType){case 1:case 4097:out=new Uint8Array(7);out[0]=65;out.set(Aa.getData().subarray(Sb,Sb+4),1);out[5]=0;out[6]=0;l(out.buffer);break;case 20:case 276:case 4116:break;case 2:8==Za?
(payloadLen=Aa.getLittleEndian16(),payload=Aa.getByte(payloadLen)):svGlobal.logger.warn("Invalid payload");break;case 43:8==Za?(payloadLen=Aa.getLittleEndian16(),payload=Aa.getByte(payloadLen)):svGlobal.logger.warn("Invalid payload");break;case 1065:case 1577:break;case 2112:baseRTT=Aa.getLittleEndian32();averageRTT=Aa.getLittleEndian32();break;case 2176:bandwidth=Aa.getLittleEndian32();averageRTT=Aa.getLittleEndian32();break;case 2240:baseRTT=Aa.getLittleEndian32();bandwidth=Aa.getLittleEndian32();
averageRTT=Aa.getLittleEndian32();break;default:svGlobal.logger.warn("Invalid msg channel type:"+reqType)}break;case 62:b(Ha.getUnicodeString(Ha.getEnd()-Ha.getPosition(),!1));default:if(J.onmessage)J.onmessage(c)}}else{q=parseInt(a.substring(0,2),16);var eb=a.substring(2);switch(q){case 0:var Tb=v.substring(v.indexOf("?")+1);l("00"+Tb);l("87"+navigator.userAgent);break;case 15:if(J){Ub=bb=!1;ja=new x;if(eb){var ub=JSON.parse(eb);ub.capability&&J&&(J.sessionInfo.suppressOutput=!!ub.capability.suppressOutput)}if(!M&&
J&&J.onready)J.onready()}break;case 26:bb=!0;break;case 56:J.sessionInfo.appInfo=JSON.parse(eb);break;case 62:b(eb)}J.onmessage(c)}}function b(c){var b=parseInt(c.substring(0,1),16);c=c.substring(1);switch(b){case 0:c=JSON.parse(c),C(),ta=!0,b=c.width,c=c.height,b==D&&c==H||p(b,c,!1,!1)}}function lb(c){var b=c.getByte();if(0==b){svGlobal.logger.info("Send history...");var a=new Uint8Array(4);a[0]=29;a[2]=1;a[3]=1;K.send(a.buffer);N.getHistory(l,function(){ga&&ga.begin("his_mppc");(a=wa.toPDU())&&
K.send(a.buffer);ga&&ga.end("his_mppc");if(xa){ga&&ga.begin("his_mppc61");var c=xa.toPDU();c&&K.send(c.buffer);ga&&ga.end("his_mppc61")}ga&&ga.begin("his_order");K.send(ja.toPDU().buffer);ga&&ga.end("his_order");a=new Uint8Array(5);a[0]=29;a[2]=1;a[3]=0;a[4]=1;K.send(a.buffer)})}else switch(b=c.getByte(),b){case 0:svGlobal.logger.warn("Received history");J.sessionInfo.suppressOutput&&va.monitorDef&&524292==J.sessionInfo.appInfo.protocolVersion?(J.suppressOutput(!0),J.suppressOutput(!1)):J.refreshOutput(0,
0,D-1,H-1);if(J.onHistoryReceived)J.onHistoryReceived();break;case 1:break;case 2:ga&&ga.begin("his_mppc_dec");wa.fromStream(c);ga&&ga.end("his_mppc_dec");break;case 3:ga&&ga.begin("his_order_dec");ja.fromStream(c);ga&&ga.end("his_order_dec");break;case 9:xa||(xa=new Bulk61Data);ga&&ga.begin("his_mppc_dec61");xa.fromStream(c);ga&&ga.end("his_mppc_dec61");break;default:N.setHistory(b,c)}if(J.onReqHistory)J.onReqHistory()}function ea(c,b,a,d,q,m,f,k){this.x=c;this.y=b;this.width=a;this.height=d;this.mask=
q;this.pixel=m;this.bpp=f;this.cache_idx=k}function Ta(c,b){if(!Vb){var a=c.getLittleEndian16();var d=c.getLittleEndian16();var q=c.getLittleEndian16();var m=c.getLittleEndian16();var f=c.getLittleEndian16();var k=c.getLittleEndian16();var e=c.getLittleEndian16();var n=c.getBytes(e);k=c.getBytes(k);if(0>d||d>=m-1)d=0;0>q?q=0:q>=f&&(q=f-1);for(var h=0;h<e&&0==n[h];h++);h=new ea(d,q,m,f,k,n,b,a);d=h.x;q=h.y;m=h.width;f=h.height;e=h.mask;n=h.pixel;k=h.bpp;for(var h=h.cache_idx,r=new Uint32Array(m*f),
l=r[0]=0,u=!0,t=e.length,x=0;x<t;x++)if(0!=e[x]){u=!1;break}for(var w,x=0;x<f;x++)for(t=0;t<m;t++){r[l]=Ra(t,x,m,f,k,n);if(!u){w=x;1!=k&&(w=f-w-1);w=8*w*((m+7)/8|0)+t;w=0==(e[w/8>>0]&128>>w%8)?1:0;if(0==w&&0!=r[l])r[l]=~r[l],r[l]|=4278190080;else if(1==w||0!=r[l])r[l]|=4278190080;32==k&&-1==r[l]&&0==w&&(r[l]=0)}l++}d=new pa(h,r,d,q,m,f,k,n.length,e.length);N.putCursor(h,d);N.setCursor(a)}}function Ra(c,b,a,d,q,m){1!=q&&(b=d-b-1);b=(b*a+c)*q;a=b/8>>0;c=m[a]&255;switch(q){case 1:return 0==(c&128>>b%
8)?0:4294967295;case 8:return 0==c?0:4294967295;case 15:return c|=(m[a+1]&255)<<8,q=Array(4),ec(c,15,q,0),q[0]<<16|q[1]<<8|q[2];case 16:return c|=(m[a+1]&255)<<8,q=Array(4),ec(c,16,q,0),q[0]<<16|q[1]<<8|q[2];case 24:return(m[a+2]&255)<<16|(m[a+1]&255)<<8|c;case 32:return(m[a+3]&255)<<24|(m[a+2]&255)<<16|(m[a+1]&255)<<8|c}svGlobal.logger.warn("invalid bpp value for Xor Mask.");return 0}function pa(c,b,a,d,q,m,f,k,e){function h(){var c=0;if(b)for(var a=0,d=b.length;a<d;a++)0!=b[a]&&(c+=a%q+(a/q|0));
return c}function r(c){switch(c){case 0:return"none";case 507:return"text";case 2046:case 4359:return"default";default:return""}}this.cache_idx=c;this.rawData=b;this.none=!b;this.hotX=a;this.hotY=d;this.width=q;this.height=m;this.xorSize=k;this.andSize=e;this.result="";this.distance=0;this.bpp=f;this.system="";b&&(this.distance||(this.distance=h()),this.system||(this.system=r(this.distance),"none"==this.system&&(b=null)));c="";if(!this.system&&b){f=q*m*4;c=62+f+k+e;var l=new Uint8Array(c);c=new hi5.DataBuffer(l,
0,c);c.setLittleEndian16(0);c.setLittleEndian16(2);c.setLittleEndian16(1);c.setByte(q);c.setByte(m);c.setByte(0);c.setByte(0);c.setLittleEndian16(a);c.setLittleEndian16(d);c.setLittleEndian32(40+f+k+e);c.setLittleEndian32(22);c.setLittleEndian32(40);c.setLittleEndian32(q);c.setLittleEndian32(2*m);c.setLittleEndian16(1);c.setLittleEndian16(32);c.setLittleEndian32(0);c.setLittleEndian32(k+e);c.setLittleEndian32(0);c.setLittleEndian32(0);c.setLittleEndian32(0);c.setLittleEndian32(0);for(a=m-1;0<=a;a--)for(d=
0;d<q;d++)m=b[q*a+d],c.setByte(m&255),c.setByte(m>>8&255),c.setByte(m>>16&255),c.setByte(m>>24&255);c="data:image/x-icon;base64,"+hi5.Base64.enc(c.getData())}this.url=c}function ya(c){var b=0;c.skipPosition(2);var a=c.getLittleEndian16();c.skipPosition(2);var d=Array(a);var q=Array(a);var m=Array(a);c=c.getBytes(3*a);for(var f=0;f<a;f++)d[f]=c[b],q[f]=c[b+1],m[f]=c[b+2],b+=3;256==a&&(ja.paletteRdp||(ja.paletteRdp=Array(3)),ja.paletteRdp[0]=d,ja.paletteRdp[1]=q,ja.paletteRdp[2]=m)}function F(c,b){for(var d=
0,q,m;d<b;){q=c.getByte();m=q&3;switch(m){case 1:var f=c,k=q;0!=(k&8)&&(ja.orderType=f.getByte());var e=void 0,h=f,l=Ia[ja.orderType],n=0;0!=(k&64)&&l--;0!=(k&128)&&(l=2>l?0:l-2);for(var u=0;u<l;u++)e=h.getByte(),n|=e<<8*u;var t=n;if(0!=(k&4)){if(0==(k&32)){var x=f,w=ja.bounds,v=x.getByte();0!=(v&1)?w.left=W(x,w.left,!1):0!=(v&16)&&(w.left=W(x,w.left,!0));0!=(v&2)?w.top=W(x,w.top,!1):0!=(v&32)&&(w.top=W(x,w.top,!0));0!=(v&4)?w.right=W(x,w.right,!1):0!=(v&64)&&(w.right=W(x,w.right,!0));0!=(v&8)?w.bottom=
W(x,w.bottom,!1):0!=(v&128)&&(w.bottom=W(x,w.bottom,!0))}var B=ja.bounds;ka=B.left;0>ka&&(ka=0);aa=B.top;0>aa&&(aa=0);da=B.right;da>=D&&(da=D-1);ba=B.bottom;ba>=H&&(ba=H-1)}var p=0!=(k&16);ua&&13!=ja.orderType&&(ua.on=!1);switch(ja.orderType){case 0:var y=f,z=ja.destBlt,la=t,A=p;0!=(la&1)&&(z.x=W(y,z.x,A));0!=(la&2)&&(z.y=W(y,z.y,A));0!=(la&4)&&(z.cx=W(y,z.cx,A));0!=(la&8)&&(z.cy=W(y,z.cy,A));0!=(la&16)&&(z.opcode=y.getByte()&15);var Ka=z.x,C=z.y,I=z.cx,F=z.cy,Q=z.opcode;if(!(Ka>D||C>H)){var lb=Ka+
I-1;lb>da&&(lb=da);Ka<ka&&(Ka=ka);var I=lb-Ka+1,O=C+F-1;O>ba&&(O=ba);C<aa&&(C=aa);F=O-C+1;1>I||1>F||N.bitBlt(Q,D,Ka,C,I,F,null,0,0,0)}break;case 1:var M=void 0,K=f,ea=ja.patBlt,P=t,R=p;0!=(P&1)&&(ea.x=W(K,ea.x,R));0!=(P&2)&&(ea.y=W(K,ea.y,R));0!=(P&4)&&(ea.cx=W(K,ea.cx,R));0!=(P&8)&&(ea.cy=W(K,ea.cy,R));0!=(P&16)&&(ea.opcode=K.getByte(),ea.opcode=ea.opcode&3|(ea.opcode&48)>>2);0!=(P&32)&&(ea.backgroundColor=Ba(K));0!=(P&64)&&(ea.foregroundColor=Ba(K));var U=ea.brush,Ta=P>>7;0!=(Ta&1)&&(U.xOrigin=
K.getByte());0!=(Ta&2)&&(U.yOrigin=K.getByte());0!=(Ta&4)&&(U.style=K.getByte());var X=U.pattern;0!=(Ta&8)&&(X[0]=K.getByte());if(0!=(Ta&16))for(var S=1;8>S;S++)X[S]=K.getByte();U.pattern=X;var ga=ea.x,pa=ea.y;if(!(ga>da||pa>ba)){var Z=ea.opcode,T=ga,na=pa,ya=ea.cx,E=ea.cy,V=ea.foregroundColor,Ra=ea.backgroundColor,ra=ea.brush.xOrigin,ta=ea.brush.yOrigin,fa=ea.brush.style,va=ea.brush.pattern,V=Sa(V),Ra=Sa(Ra),wa=T+ya-1;wa>da&&(wa=da);T<ka&&(T=ka);var ya=wa-T+1,xa=na+E-1;xa>ba&&(xa=ba);na<aa&&(na=
aa);E=xa-na+1;if(!(1>ya||1>E))switch(fa){case 0:for(var M=new Uint32Array(ya*E),sa=0;sa<M.length;sa++)M[sa]=V;N.bitBlt(Z,D,T,na,ya,E,M,ya,0,0);break;case 2:svGlobal.logger.warn("hatch");break;case 3:for(var M=new Uint32Array(ya*E),Na=0,sa=0;sa<E;sa++)for(var Xa=0;Xa<ya;Xa++)M[Na]=0==(va[(sa+ta)%8]&1<<(Xa+ra)%8)?V:Ra,Na++;N.bitBlt(Z,D,T,na,ya,E,M,ya,0,0);break;default:svGlobal.logger.warn("Unsupported brush style "+fa)}}break;case 2:var Ca=f,ca=ja.screenBlt,Ha=t,mb=p;0!=(Ha&1)&&(ca.x=W(Ca,ca.x,mb));
0!=(Ha&2)&&(ca.y=W(Ca,ca.y,mb));0!=(Ha&4)&&(ca.cx=W(Ca,ca.cx,mb));0!=(Ha&8)&&(ca.cy=W(Ca,ca.cy,mb));0!=(Ha&16)&&(ca.opcode=Ca.getByte()&15);0!=(Ha&32)&&(ca.srcX=W(Ca,ca.srcX,mb));0!=(Ha&64)&&(ca.srcY=W(Ca,ca.srcY,mb));var nb=ca.x,ob=ca.y;if(!(nb>da||ob>ba)){var Ya=ca.cx,qa=ca.cy,hb=ca.opcode,Va=ca.srcX,jb=ca.srcY,cb=nb+Ya-1;cb>da&&(cb=da);nb<ka&&(nb=ka);var Ya=cb-nb+1,Pa=ob+qa-1;Pa>ba&&(Pa=ba);ob<aa&&(ob=aa);qa=Pa-ob+1;Va+=nb-ca.x;jb+=ob-ca.y;1>Ya||1>qa||(12==hb?N.moveArea(Va,jb,Ya,qa,nb-Va,ob-jb):
N.bitBlt(hb,Ya,nb,ob,Ya,qa,null,Ya,Va,jb))}break;case 9:var ab=void 0,Da=f,Y=ja.line,pb=t,bb=p;0!=(pb&1)&&(Y.mixmode=Da.getLittleEndian16());0!=(pb&2)&&(Y.startX=W(Da,Y.startX,bb));0!=(pb&4)&&(Y.startY=W(Da,Y.startY,bb));0!=(pb&8)&&(Y.endX=W(Da,Y.endX,bb));0!=(pb&16)&&(Y.endY=W(Da,Y.endY,bb));0!=(pb&32)&&(Y.backgroundColor=Ba(Da));0!=(pb&64)&&(Y.opcode=Da.getByte());var wb=Y.pen,Mb=pb>>7;0!=(Mb&1)&&(wb.style=Da.getByte());0!=(Mb&2)&&(wb.width=Da.getByte());0!=(Mb&4)&&(wb.color=Ba(Da));var Ma=Y.startX,
za=Y.startY,Ea=Y.endX,Nb=Y.endY,xb=Y.pen.color,Ub=Y.opcode-1;za==Nb?(Ma>Ea&&(ab=Ma,Ma=Ea,Ea=ab),Ma<ka&&(Ma=ka),Ea>da&&(Ea=da)):Ma==Ea&&(za>Nb&&(ab=za,za=Nb,Nb=ab),za<aa&&(za=aa),za>ba&&(za=ba));G(Ma,za,Ea,Nb,xb,Ub);break;case 10:var Ab=f,ha=ja.rectangle,kb=t,Bb=p;0!=(kb&1)&&(ha.x=W(Ab,ha.x,Bb));0!=(kb&2)&&(ha.y=W(Ab,ha.y,Bb));0!=(kb&4)&&(ha.cx=W(Ab,ha.cx,Bb));0!=(kb&8)&&(ha.cy=W(Ab,ha.cy,Bb));0!=(kb&16)&&(Ga=Ga&4294967040|Ab.getByte());0!=(kb&32)&&(Ga=Ga&4294902015|Ab.getByte()<<8);0!=(kb&64)&&(Ga=
Ga&4278255615|Ab.getByte()<<16);ha.color=Ga;var Ob=ha.x,Cb=ha.y,Qa=ha.cx,Rb=ha.cy;if(!(Ob>da||Cb>ba)){var qb=Ob+Qa-1;qb>da&&(qb=da);Ob<ka&&(Ob=ka);var Qa=qb-Ob+1,Db=Cb+Rb-1;Db>ba&&(Db=ba);Cb<aa&&(Cb=aa);Rb=Db-Cb+1;1>Qa||1>Rb||N.fillRect(Ob,Cb,Qa,Rb,Sa(ha.color))}break;case 11:var sb=f,oa=ja.deskSave,tb=t,db=p;0!=(tb&1)&&(oa.offset=sb.getLittleEndian32());0!=(tb&2)&&(oa.left=W(sb,oa.left,db));0!=(tb&4)&&(oa.top=W(sb,oa.top,db));0!=(tb&8)&&(oa.right=W(sb,oa.right,db));0!=(tb&16)&&(oa.bottom=W(sb,oa.bottom,
db));0!=(tb&32)&&(oa.action=sb.getByte());var Aa=oa.right-oa.left+1,Sb=oa.bottom-oa.top+1;0==oa.action?1>Aa||1>Sb||N.saveDesktop(oa.left,oa.top,Aa,Sb,oa.offset):N.restoreDesktop(oa.left,oa.top,Aa,Sb,oa.offset);break;case 13:a:{var Za=f,ia=ja.memBlt,eb=t,Tb=p;0!=(eb&1)&&(ia.cacheID=Za.getByte(),ia.colorTable=Za.getByte());0!=(eb&2)&&(ia.x=W(Za,ia.x,Tb));0!=(eb&4)&&(ia.y=W(Za,ia.y,Tb));0!=(eb&8)&&(ia.cx=W(Za,ia.cx,Tb));0!=(eb&16)&&(ia.cy=W(Za,ia.cy,Tb));0!=(eb&32)&&(ia.opcode=Za.getByte()&15);0!=(eb&
64)&&(ia.srcX=W(Za,ia.srcX,Tb));0!=(eb&128)&&(ia.srcY=W(Za,ia.srcY,Tb));0!=(eb&256)&&(ia.cacheIDX=Za.getLittleEndian16());var ub=ia.x,rb=ia.y;if(!(ub>da||rb>ba)){var vb=ia.cx,Oa=ia.cy,Pb=ia.srcX,$a=ia.srcY,Kb=ub+vb-1;Kb>da&&(Kb=da);ub<ka&&(ub=ka);var vb=Kb-ub+1,Eb=rb+Oa-1;Eb>ba&&(Eb=ba);rb<aa&&(rb=aa);Oa=Eb-rb+1;Pb+=ub-ia.x;$a+=rb-ia.y;if(ua&&(ua.verify(ub,rb,vb,Oa),ua.on))break a;N.drawBitmap(ia.cacheID,ia.cacheIDX,ub,rb,vb,Oa,Pb,$a,ia.opcode)}}break;case 22:var Fb=f,g=ja.polyLine,Gb=t,Yb=p;0!=(Gb&
1)&&(g.x=W(Fb,g.x,Yb));0!=(Gb&2)&&(g.y=W(Fb,g.y,Yb));0!=(Gb&4)&&(g.opcode=Fb.getByte());0!=(Gb&16)&&(g.foregroundColor=Ba(Fb));0!=(Gb&32)&&(g.lines=Fb.getByte());if(0!=(Gb&64)){var Zb=Fb.getByte();g.dataSize=Zb;g.data=Fb.getBytes(Zb)}var Qb=g.x,Vb=g.y,ec=g.foregroundColor,hc=g.lines,nc=g.dataSize,ad=g.data,Ic=Array(1);Ic[0]=Math.floor((hc-1)/4)+1;for(var oc=0,ee=0,fe=g.opcode-1,bd=0;bd<hc&&Ic[0]<nc;bd++){var ge=Qb,he=Vb;0==bd%4&&(oc=ad[ee++]);0==(oc&192)&&(oc|=192);0!=(oc&64)&&(Qb+=Jc(ad,Ic));0!=
(oc&128)&&(Vb+=Jc(ad,Ic));G(ge,he,Qb,Vb,ec,fe);oc<<=2}break;case 27:var Fa=f,ma=ja.text2,Ja=t;0!=(Ja&1)&&(ma.font=Fa.getByte());0!=(Ja&2)&&(ma.flags=Fa.getByte());0!=(Ja&4)&&(ma.opcode=Fa.getByte());0!=(Ja&8)&&(ma.mixmode=Fa.getByte());0!=(Ja&16)&&(ma.foregroundColor=Ba(Fa));0!=(Ja&32)&&(ma.backgroundColor=Ba(Fa));0!=(Ja&64)&&(ma.clipLeft=Fa.getLittleEndian16());0!=(Ja&128)&&(ma.clipTop=Fa.getLittleEndian16());0!=(Ja&256)&&(ma.clipRight=Fa.getLittleEndian16());0!=(Ja&512)&&(ma.clipBottom=Fa.getLittleEndian16());
0!=(Ja&1024)&&(ma.boxLeft=Fa.getLittleEndian16());0!=(Ja&2048)&&(ma.boxTop=Fa.getLittleEndian16());0!=(Ja&4096)&&(ma.boxRight=Fa.getLittleEndian16());0!=(Ja&8192)&&(ma.boxBottom=Fa.getLittleEndian16());0!=(Ja&16384)&&Fa.skipPosition(1);0!=(Ja&32768)&&Fa.skipPosition(1);0!=(Ja&65536)&&Fa.skipPosition(1);0!=(Ja&131072)&&Fa.skipPosition(1);0!=(Ja&262144)&&Fa.skipPosition(7);0!=(Ja&524288)&&(ma.x=Fa.getLittleEndian16());0!=(Ja&1048576)&&(ma.y=Fa.getLittleEndian16());if(0!=(Ja&2097152)){var Cd=Fa.getByte();
ma.length=Cd;ma.text=Fa.getBytes(Cd)}var ie=ma.font,je=ma.flags,ke=ma.mixmode,le=Sa(ma.foregroundColor),me=Sa(ma.backgroundColor),Dd=ma.clipLeft,Ed=ma.clipTop,ne=ma.clipRight,oe=ma.clipBottom,Kc=ma.boxLeft,Fd=ma.boxTop,pe=ma.boxBottom,qe=ma.x,re=ma.y,se=ma.length,te=ma.text,cd=ma.boxRight-Kc;Kc+cd>D&&(cd=D-Kc);N.drawText(ie,je,ke,le,me,Dd,Ed,ne-Dd,oe-Ed,Kc,Fd,cd,pe-Fd,qe,re,se,te,ka,aa,da,ba);break;default:svGlobal.logger.warn("XXX Order type "+ja.orderType)}0!=(k&4)&&ic();break;case 2:var Gd=c,Hd=
q>>2;switch(Hd){case 11:var Lc=Gd,Id=Lc.getLittleEndian16()-3,ue=Lc.getPosition()+Id;J.onAltSecWindows(Lc,Id);Lc.setPosition(ue);break;case 13:Gd.getLittleEndian32();break;default:svGlobal.logger.warn("Alt Sec order:"+Hd)}break;case 3:var Hb=c;var Jd=Hb.getLittleEndian16();var Mc=Hb.getLittleEndian16();var Kd=Hb.getByte();var ve=Hb.getPosition()+Jd+7;if(Hb.has(Jd+7)){switch(Kd){case 0:var Ld=void 0,Wb=Hb,we=Wb.getByte();Wb.skipPosition(1);var dd=Wb.getByte(),Nc=Wb.getByte(),Oc=Wb.getByte(),Pc=Math.floor((Oc+
7)/8),xe=Wb.getLittleEndian16(),ye=Wb.getLittleEndian16(),ze=Wb.getPosition();Wb.skipPosition(xe);L!=Oc&&(svGlobal.logger.warn("Server limited colour depth to "+Oc+" bits"),a(Oc,!0));var ed=Array(dd*Nc*Pc);ed[0]=0;for(var fd=dd*Pc,Qc=0;Qc<Nc;Qc++)Ld=ze+(Nc-Qc-1)*fd,Wb.copyToByteArray(ed,Qc*fd,Ld,fd);var Ae=Ib(ed,Pc);N.putBitmap(we,ye,new rdpcodecs.Bitmap(Ae,dd,Nc,0,0,8*Pc,null,0));break;case 1:svGlobal.logger.info("TODO: color cache");break;case 2:var Md=void 0,tc=void 0,fb=Hb,Be=Mc,Ce=fb.getByte();
fb.getByte();var gd=fb.getByte(),hd=fb.getByte(),uc=fb.getByte(),De=Math.floor((uc+7)/8),Ee=fb.getLittleEndian16(),Fe=fb.getLittleEndian16();L!=uc&&(svGlobal.logger.warn("Server limited colour depth to "+uc+" bits"),a(uc,!0));0!=(Be&1024)?tc=Ee:(fb.skipPosition(2),tc=fb.getLittleEndian16(),fb.skipPosition(2),fb.skipPosition(2));var Md=1!=De?Jb(gd,hd,tc,fb.getData(),fb.getPosition()):fc(gd,hd,tc,fb.getData(),fb.getPosition()),Ge=fb.getBytes(tc);N.putBitmap(Ce,Fe,new rdpcodecs.Bitmap(Md,gd,hd,0,0,uc,
Ge,1));break;case 3:for(var Nd=void 0,id=void 0,jd=void 0,Od=void 0,Pd=void 0,Qd=void 0,Rd=void 0,Sd=void 0,Td=void 0,gc=Hb,Sd=gc.getByte(),Rd=gc.getByte(),Ud=0;Ud<Rd;Ud++)Qd=gc.getLittleEndian16(),Pd=gc.getLittleEndian16(),Od=gc.getLittleEndian16(),jd=gc.getLittleEndian16(),id=gc.getLittleEndian16(),Nd=id*Math.floor((jd+7)/8)+3&-4,Td=new r(Pd,Od,jd,id,gc.getBytes(Nd)),N.putFont(Sd,Qd,Td);break;case 4:Xb(Hb,Mc,!1);break;case 5:Xb(Hb,Mc,!0);break;case 7:svGlobal.logger.info("CacheBrush...=");break;
case 8:var pc=void 0,gb=Hb,Vd=Mc&7,Wd=gb.getLittleEndian16();gb.skipPosition(8);var Rc=gb.getByte();L!=Rc&&(svGlobal.logger.warn("Server limited colour depth to "+Rc+" bits"),a(Rc,!0));gb.skipPosition(2);var kd=gb.getByte(),vc=gb.getLittleEndian16(),wc=gb.getLittleEndian16(),Xd=gb.getLittleEndian32(),Yd=gb.getPosition();if(1==kd){yb(gb,Rc,vc,wc);var He=zb.getData(),Ie=zb.getDataSize(),pc=new Uint32Array(Ie);rdpcodecs.flipimage(He,0,pc,vc,wc,1);var Je=gb.getPosition()-Yd;gb.setPosition(Yd);var Ke=
gb.getBytes(Je);N.putBitmap(Vd,Wd,new rdpcodecs.Bitmap(pc,vc,wc,0,0,32,Ke,2))}else if(0==kd){var Zd=rdpBitmap.byte2int(gb.getData(),Xd,gb.getPosition()),pc=new Uint32Array(Zd.length);rdpcodecs.flipimage(Zd,0,pc,vc,wc,1);N.putBitmap(Vd,Wd,new rdpcodecs.Bitmap(pc,vc,wc,0,0,32,null,0))}else svGlobal.logger.warn("XXX invalid codec id:"+kd);gb.skipPosition(Xd);break;default:svGlobal.logger.warn("invalid second Order, type="+Kd)}Hb.setPosition(ve)}ua&&(ua.on=!1)}d++}}function Xb(c,b,d){var q;var m=b&7;
var f=((b&120)>>3)-2;b=(b&65408)>>7;Kb!=f&&(a(8*f,!0),svGlobal.logger.warn("Server limited colour depth to "+f+" bytes"));0!=(b&2)&&c.skipPosition(8);if(0!=(b&1))var k=q=vb.readVar2Bytes(c);else q=vb.readVar2Bytes(c),k=vb.readVar2Bytes(c);var e=vb.readVar4Bytes(c);var h=vb.readVar2Bytes(c);d&&0==(b&8)&&c.skipPosition(8);if(d){d=1!=f?Jb(q,k,e,c.getData(),c.getPosition()):fc(q,k,e,c.getData(),c.getPosition());c=c.getBytes(e);if(!d){svGlobal.logger.warn("Failed to decompress bitmap data");return}q=new rdpcodecs.Bitmap(d,
q,k,0,0,8*f,c,1)}else{d=Array(q*k*f);d[0]=0;var l=c.getPosition(),r=q*f;for(e=0;e<k;e++){var n=l+(k-e-1)*r;c.copyToByteArray(d,e*r,n,r)}c=Ib(d,f);q=new rdpcodecs.Bitmap(c,q,k,0,0,8*f,null,0)}N.putBitmap(m,h,q);0!=(b&2)&&svGlobal.logger.warn("XXX:TODO, persistent")}function W(c,b,a){return a?(c=c.getByte()<<24>>24,b+c):b=c.getLittleEndian16()<<16>>16}function Ba(c){var b;var a=b=c.getByte();b=c.getByte();a|=b<<8;b=c.getByte();return a|b<<16}function mb(c){for(var b,d,q,m,f,k,e,h,l,r=c.getLittleEndian16(),
n=0;n<r;n++)if(b=c.getLittleEndian16(),d=c.getLittleEndian16(),q=c.getLittleEndian16(),m=c.getLittleEndian16(),f=c.getLittleEndian16(),k=c.getLittleEndian16(),e=c.getLittleEndian16(),h=c.getLittleEndian16(),l=c.getLittleEndian16(),q=q-b+1,m=m-d+1,L!=e&&(svGlobal.logger.warn("Server limited colour depth to "+e+" bits"),a(e,!0)),0==h){h=f*Kb;l=k*h;e=new Uint8Array(l);for(var u=c.getPosition(),t=0;t<k;t++)Yb(c.getData(),u,e,(k-t-1)*h,h),u+=h;c.skipPosition(l);e=Ib(e,Kb);N.setRGBs(b,d,q,m,e,0,f)}else 0!=
(h&1024)?e=l:(c.skipPosition(2),e=c.getLittleEndian16(),c.skipPosition(4)),h=c.getData(),l=e,u=c.getPosition(),t=d,d=m,m=Kb,1>q*d*f*k||(1!=m?N.setRGBs(b,t,q,d,Jb(f,k,l,h,u),0,f):(k=fc(f,k,l,h,u),h=t,m=Ib(k,m),N.setRGBs(b,h,q,d,m,0,f))),c.skipPosition(e)}function ic(){ka=0;da=D-1;aa=0;ba=H-1}function G(c,b,a,d,q,m){var f=Math.min(c,a),k=Math.max(c,a),e=Math.min(b,d),h=Math.max(b,d);q=Sa(q);if(!(f>=ka&&k<=da&&e>=aa&&h<=ba)){if(f>da||k<ka||e>ba||h<aa)return;if(c==a)b>d&&(f=b,b=d,d=f),b<aa&&(b=aa),d>
ba&&(d=ba);else if(b==d)c>a&&(f=c,c=a,a=f),c<ka&&(c=ka),a>da&&(a=da);else{f=ja._line;f.set(c,b,a,d);k=f.intersection(ka,aa,da,aa);e=[];k&&e.push(k.x,k.y);(k=f.intersection(da,aa,da,ba))&&e.push(k.x,k.y);(k=f.intersection(ka,ba,da,ba))&&e.push(k.x,k.y);(k=f.intersection(ka,aa,ka,ba))&&e.push(k.x,k.y);2==e.length&&(c>=ka&&c<=da&&b>=aa&&b<=ba?e.push(c,b):a>=ka&&a<=da&&d>=aa&&d<=ba&&e.push(a,d));if(4!=e.length)return;c=e[0];b=e[1];a=e[2];d=e[3]}}12==m?N.drawLine(c,b,a,d,q):N.drawLineExt(c,b,a,d,q,m)}
function Jc(c,b){var a=c[b[0]++]&255,d=a&128,a=0!=(a&64)?a|-64:a&63;0!=d&&(a=a<<8|c[b[0]++]&255);return a}function Qb(c){if(J)if(svGlobal.logger.warn("closed "+(J.sessionInfo.appInfo?J.sessionInfo.appInfo.numericId:0)),J&&(ta=!1),Ub)svGlobal.logger.info("Req credential");else{ja=null;"undefined"!=typeof rdp8bulkData&&rdp8bulkData.release();zb=yb=Na=v=null;try{if(null!=Va&&(Va.exit(),Va=null),J.onclose)J.onclose(bb);else svGlobal.logger.info("onclose: null")}catch(Ka){}Ha=null;K&&(K.onopen=null,K.onmessage=
null,K.onclose=null,K=K.onerror=null);wb=null;wa&&(wa.release(),wa=null);xa&&(xa.release(),xa=null);J=null}}function ec(c,b,a,d){switch(b){case 16:b=c>>8&248;var q=c>>3&252;c=c<<3&255;a[d]=b|b>>5;a[d+1]=q|q>>6;a[d+2]=c|c>>5;a[d+3]=255;break;case 15:b=c>>7&248;q=c>>2&248;c=c<<3&255;a[d]=b|b>>5;a[d+1]=q|q>>5;a[d+2]=c|c>>5;a[d+3]=255;break;case 8:a[d]=ja.paletteRdp[0][c];a[d+1]=ja.paletteRdp[1][c];a[d+2]=ja.paletteRdp[2][c];a[d+3]=255;break;case 32:a[d]=c&255,a[d+1]=c>>8&255,a[d+2]=c>>16&255,a[d+3]=
c>>24&255;default:a[d]=c&255,a[d+1]=c>>8&255,a[d+2]=c>>16&255,a[d+3]=255}}function Ib(c,b){var a=c.length/b>>0,d=new Uint32Array(a),q=Sa;switch(b){case 1:for(var m=0;m<a;m++)d[m]=q(c[m]);break;case 2:for(m=0;m<a;m++)d[m]=q(c[2*m+1]<<8|c[2*m]);break;default:for(m=0;m<a;m++)d[m]=q(c[m*b+2]<<16)|c[m*b+1]<<8|c[m*b]}return d}this.sessionInfo={domain:"",userName:"",sessionId:0,joinedSessions:[],suppressOutput:!1,appInfo:null};this.mode=0;this.remoteAppLogin=!0;var J=this,bb=!1,Ub=!1,hb="object"==typeof v?
v:null,va=hb?{}:hi5.string.queryToObj(v.substring(v.indexOf("?")+1)),Yb=hi5.Arrays.arraycopy,ga=null,wa=new BulkData,xa=na(va.decompressingRDP61)?new Bulk61Data:null,ua=null;this.enableUpdateFix=function(){ua=new Ca;svGlobal.logger.warn("UpdateFix enabled")};this.protocol=hb?"":v.substring(0,v.indexOf("://")).toLowerCase();this.setProfiler=function(c){ga=c};this.getProfiler=function(){return ga};this.gateway=function(){if(hb)return"";var c=v.lastIndexOf("/RDP?");-1==c&&(c=v.lastIndexOf("/JOIN?"));
-1==c&&(c=v.lastIndexOf("/PLAY?"));return v.substring(0,c).replace(/wss\:\/\//ig,"https://").replace(/ws\:\/\//ig,"http://")}();this.getGatewayAddr=function(){var c=J.gateway;J.ongetgatewayaddress&&(c=J.ongetgatewayaddress(c));return c};var M="object"==typeof v||0<v.indexOf("/PLAY?"),Zb=!M&&0<v.indexOf("invitation=");if(Zb){var U=decodeURIComponent(v),Pb=U.indexOf(' USERNAME="');0<Pb&&(Pb+=11,U=U.substring(Pb,U.indexOf('"',Pb)),v+="&novice="+U+"&server="+U);v+="&mapClipboard=on"}if(M)this.mode=1,
hb?v="":(D=640,H=480);else if(0<v.indexOf("/JOIN?")||Zb)this.mode=2;va.symlink&&va.parameters&&hi5.string.queryToObj(va.parameters,va);va.gateway||(v+="&gateway="+encodeURIComponent(J.gateway));"useSSL"in va||(v+="&useSSL="+("wss"==J.protocol));this.getDisplayName=ra;this.server=ra();this.port=parseInt(va.port,10);this.getURL=function(){return v};this.getColor=function(){return L};var nc=hi5.graphic.Rectangle,Vb=0<v.indexOf("nocurosr=on"),O=0<v.indexOf("startProgram=app");v.indexOf("mapDisk=on");
this.isRemoteApp=function(){return O};var K=null,ta=!1,sa=!1,ka=0,aa=0,da=D-1,ba=H-1,Kb=0,Va=null,Sa=h,Jb=rdpBitmap.decompressInt16,fc=rdpBitmap.decompress;a(L,!0);this.setColor=function(c){a(c,!1)};this.setResolution=function(c,b){p(c,b,!1)};var ab={tag:0,channels:0,bitsPerSample:0,samplePerSec:22050,toStream:function(c){c.setLittleEndian16(this.tag);c.setLittleEndian16(this.channels);c.setLittleEndian16(this.bitsPerSample);c.setLittleEndian32(this.samplePerSec)},fromStream:function(c){this.tag=
c.getLittleEndian16();this.channels=c.getLittleEndian16();this.bitsPerSample=c.getLittleEndian16();this.samplePerSec=c.getLittleEndian32()}};this.setAudioFormat=function(c){ab.tag=c.tag;ab.channels=c.channels;ab.samplePerSec=c.samplePerSec;ab.bitsPerSample=c.bitsPerSample};this.running=function(){return ta};this.setJoinMode=function(c){ta&&l("8E1"+c)};this.setJoinCloseMode=function(c){ta&&l("8EB3\t"+c)};this.refuseControl=function(c){ta&&l("8E3"+c)};this.giveControl=function(c){ta&&l("8E4"+c)};this.pauseSession=
function(c,b){ta&&l("8EB"+(b?1:0)+"\t"+c)};this.closeSession=function(c){ta&&l("8EB2\t"+c)};this.requestControl=function(){ta&&l("8E2")};this.saveSession=function(c){ta&&l("8E9"+(c.save?1:0)+"\t"+(c.timeout||0)+"\t"+(c.id||0))};this.allowJoin=function(c,b){ta&&l("8EA"+c+"\t"+(b?1:0))};var hc=new function(){function c(){if(a&&0<a.length){var b=a.shift();hc.sendSingleKey(b.down,b.key);0<a.length?setTimeout(c,d):a=null}}var b={" ":57,space:57,pgup:201,pageup:201,pgdn:209,pagedown:209,end:207,home:199,
left:203,up:200,right:205,down:208,printscreen:183,insert:210,del:211,"delete":211,altgr:184,windows:219,windowsright:220,context:221,esc:1,backspace:14,tab:15,enter:28,meta:29,command:29,ctrl:29,shift:42,alt:56,capslock:58,f1:59,f2:60,f3:61,f4:62,f5:63,f6:64,f7:65,f8:66,f9:67,f10:68,f11:87,f12:88,numlock:69,scrolllock:70,add:78};this.sendSingleKey=function(c,a){var d=b[a.toLowerCase()];d?J.writeScancode(c,d):(d=a.length,0!=d&&(1==d?J.writeKeyCode(c,a.toUpperCase().charCodeAt(0)):c&&J.writeText(a)))};
var a=null,d=0;this.sendKeyComb=function(b,q){var m=b.split("+"),f=m.length,k;if(0!=f){var e=null,h=[];for(k=0;k<f;k++){var l=m[k];""==l&&""==e&&(l="Add");""!=l&&h.push({key:l,down:!0});e=l}f=h.length;for(k=f-1;0<=k;k--)h.push({key:h[k].key,down:!1});if(q)a=h,d=q,c();else for(k=0,f=h.length;k<f;k++)hc.sendSingleKey(h[k].down,h[k].key)}}};this.writeRawInput=function(b){l(b);if(J.onactivity)J.onactivity(b);if(Va){var c=b.substring(0,2);b=b.substring(2);if("80"==c||"81"==c||"82"==c||"83"==c){b=b.split("\t");
var a=new Uint8Array(7),d=0;var q=parseInt(b[0]);var m=parseInt(b[1]);switch(parseInt(c,16)){case 128:d=("0"==b[2]?4096:8192)|32768;break;case 129:d="0"==b[2]?4096:8192;break;case 130:d=2048;break;case 131:d="0"==b[2]?33408:33664}a[0]=32;a[1]=d&255;a[2]=d>>8;a[3]=q&255;a[4]=q>>8;a[5]=m&255;a[6]=m>>8;Va.add(new RecordingObj(a,0,7,60))}}};var ja=new x,Ga=0;this.resetStatus=C;this.notify=function(b,a){b="8E6"+b;a&&(b+="\t"+a.join(";"));l(b)};this.run=function(){I()};this.getDesktop=function(){return N};
var Ha=new hi5.DataBuffer([],0,0);this.suppressOutput=function(b){if(!J.sessionInfo.suppressOutput)return!1;void 0==b&&(b=!0);var c=new Uint8Array(b?3:11);c[0]=146;c[1]=3;c[2]=b?1:0;b||(c[3]=0,c[4]=0,c[5]=0,c[6]=0,c[7]=D-1,c[8]=D-1>>8,c[9]=H-1,c[10]=H-1>>8);K.send(c.buffer);return!0};this.refreshOutput=function(b,a,d,q){var c=new Uint8Array(d?11:3);c[0]=146;c[1]=3;c[2]=2;d&&(c[3]=b,c[4]=b>>8,c[5]=a,c[6]=a>>8,c[7]=d,c[8]=d>>8,c[9]=q,c[10]=q>>8);K.send(c.buffer)};this.sendKeyboardSynchronize=function(b,
a,d){var c=0;d&&(c|=4);a&&(c|=2);b&&(c|=1);l("8E5"+c);this.capsLock=d;this.numLock=a};var wb=new function(){var b=0,a=0,d=[0],q=new hi5.DataBuffer(d,0,0);this.addFragement=function(c,q){Yb(c.getData(),c.getPosition(),d,a,q);a+=q;b+=q};this.clearFragements=function(){q.setPosition(0);q.markEnd(b);a=b=0;return q}},Na=new rdpcodecs.RemoteFX(Z),zb=new rdpcodecs.NSCodec,yb=zb.process,Ia=[1,2,1,0,0,0,0,1,1,2,1,1,0,2,3,1,2,2,2,2,1,2,1,0,2,1,2,3],vb={readVar4Bytes:function(b){var c=b.getByte(),a=0;switch((c&
192)>>6){case 0:a=c&63;break;case 1:a=(c&63)<<8|b.getByte();break;case 2:a=(c&63)<<16;c=b.getByte();a|=c<<8;c=b.getByte();a|=c;break;case 3:a=(c&63)<<24,c=b.getByte(),a|=c<<16,c=b.getByte(),a|=c<<8,c=b.getByte(),a|=c}return a},readVar2Bytes:function(b){var c=b.getByte();return 0!=(c&128)?(c&127)<<8|b.getByte():c}};this._unload=Qb;this.close=function(){bb=!0;svGlobal.logger.info("closing...");if(K&&K.readyState!=WebSocket.CLOSING&&K.readyState!=WebSocket.CLOSED)try{for(;K&&K.readyState!=WebSocket.CLOSING&&
K.readyState!=WebSocket.CLOSED;)M||K.readyState!=WebSocket.OPEN||l("85-1"),K.close()}finally{Qb()}else Qb()}}
function BulkData(){function v(a){a=(a&1431655765)<<1|a>>>1&1431655765;a=(a&858993459)<<2|a>>>2&858993459;a=(a&252645135)<<4|a>>>4&252645135;if(0==a>>>8)return a;a=(a&16711935)<<8|a>>>8&16711935;return 0==a>>>16?a:(a&65535)<<16|a>>>16&65535}function D(a,f,e,m){var d=0,h=0,k,l,n=0!=(m&1),r=L;if(0==(m&32))return Z=0,z=e,0;0!=(m&64)&&(H=0);if(0!=(m&128)){for(m=65536;0<=--m;)r[m]=0;H=0}z=Z=0;Z=l=k=m=H;if(0==e)return 0;e+=h;do{if(0==d){if(h>=e)break;m=a[f+h++]<<24;d=8}if(0<=m){if(8>d){if(h>=e){if(0!=m)return-1;
break}m|=a[f+h++]<<24-d;d+=8}if(65536<=k)return-1;r[k++]=m>>>24&255;m<<=8;d-=8}else{m<<=1;if(0==--d){if(h>=e)return-1;m=a[f+h++]<<24;d=8}if(0<=m){if(8>d){if(h>=e)return-1;m|=a[f+h++]<<24-d;d+=8}if(65536<=k)return-1;r[k++]=(m>>>24|128)&255;m<<=8;d-=8}else{m<<=1;if(--d<(n?3:2)){if(h>=e)return-1;m|=a[f+h++]<<24-d;d+=8}if(n)switch(m>>>29){case 7:for(;9>d;d+=8){if(h>=e)return-1;m|=a[f+h++]<<24-d}m<<=3;var t=m>>>26;m<<=6;d-=9;break;case 6:for(;11>d;d+=8){if(h>=e)return-1;m|=a[f+h++]<<24-d}m<<=3;t=(m>>>
24)+64;m<<=8;d-=11;break;case 5:case 4:for(;13>d;d+=8){if(h>=e)return-1;m|=a[f+h++]<<24-d}m<<=2;t=(m>>>21)+320;m<<=11;d-=13;break;default:for(;17>d;d+=8){if(h>=e)return-1;m|=a[f+h++]<<24-d}m<<=1;t=(m>>>16)+2368;m<<=16;d-=17}else switch(m>>>30){case 3:if(8>d){if(h>=e)return-1;m|=a[f+h++]<<24-d;d+=8}m<<=2;t=m>>>26;m<<=6;d-=8;break;case 2:for(;10>d;d+=8){if(h>=e)return-1;m|=a[f+h++]<<24-d}m<<=2;t=(m>>>24)+64;m<<=8;d-=10;break;default:for(;14>d;d+=8){if(h>=e)return-1;m|=a[f+h++]<<24-d}t=(m>>>18)+320;
m<<=14;d-=14}if(0==d){if(h>=e)return-1;m=a[f+h++]<<24;d=8}if(0<=m){var u=3;m<<=1;d--}else{var v=n?14:11;do{m<<=1;if(0==--d){if(h>=e)return-1;m=a[f+h++]<<24;d=8}if(0<=m)break;if(0==--v)return-1}while(1);u=(n?16:13)-v;m<<=1;if(--d<u)for(;d<u;d+=8){if(h>=e)return-1;m|=a[f+h++]<<24-d}v=u;u=m>>>32-v&~(-1<<v)|1<<v;m<<=v;d-=v}if(65536<=k+u)return-1;t=k-t&(n?65535:8191);do r[k++]=r[t++];while(0!=--u)}}}while(1);H=k;Z=l;z=k-l;return 0}var H=0,L=new Uint8Array(65536),N=new Int32Array(8),Z=0,z=0,na=[6,6,6,7,
7,7,7,7,7,7,7,8,8,8,8,8,8,8,9,8,9,9,9,9,8,8,9,9,9,9,9,9,8,9,9,10,9,9,9,9,9,9,9,10,9,10,10,10,9,9,10,9,10,9,10,9,9,9,10,10,9,10,9,9,8,9,9,9,9,10,10,10,9,9,10,10,10,10,10,10,9,9,10,10,10,10,10,10,10,9,10,10,10,10,10,10,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,9,10,10,10,10,10,10,10,9,10,10,10,10,10,10,9,7,9,9,10,9,10,10,10,9,10,10,10,10,10,10,10,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,13,10,10,10,10,10,10,11,10,10,10,10,10,10,10,10,10,10,10,10,10,9,10,10,
10,10,10,9,10,10,10,10,10,9,10,10,10,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,9,10,10,10,10,10,10,10,10,10,10,10,10,10,9,10,8,9,9,10,9,10,10,10,9,10,10,10,9,9,8,7,13,13,7,7,10,7,7,6,6,6,6,5,6,6,6,5,6,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,8,5,6,7,7],Ca=[123,65311,65293,65063,65024,65285,65303,65128,197,65031,65299,65216,65288,65048,65307,65203,65027,162,65090,65296,65035,65026,65169,65305,65152,233,65082,65301,65042,87,65239,65309,65294,65077,65129,65314,65304,65146,65025,65315,65300,65268,65204,65033,
65308,65220,65289,65120,65136,65298,65029,65170,65185,65306,65039,65287,65110,65302,65282,65240,65256,65310,65053,59,65535,65286,65535,65137,65161,65535,65535,65068,65067,65056,65535,65211,65231,65032,65535,65248,65037,65535,65177,65535,65028,65194,65097,65535,65047,65121,65247,65535,65279,65270,65100,65535,65535,65159,65535,65316,65535,65084,65138,65535,65535,65230,65535,65278,65535,65059,65212,65034,65193,65535,65041,65535,65154,65535,65030,65178,65269,65535,65058,65101,65119,65535,65283,65249,
65535,65226,65228,65535,65049,65535,65207,65535,65535,65155,65065,65535,65535,65535,65132,65535,65261,65535,65535,65094,65116,65045,65535,65243,65190,65535,65535,65092,65535,65036,65535,65173,65276,65535,65535,65208,5833,65535,65264,65535,65080,65535,65535,65133,65150,65535,65535,65535,65535,65115,65244,65535,65535,65260,65095,65055,65535,65151,65174,65535,65535,65189,65535,65040,65088,65074,65215,65535,65535,65236,65265,65535,65535,65535,65141,65535,65535,65165,65073,65535,65125,65051,65535,65252,
65275,65535,65535,65106,65535,65038,65535,65181,65199,65535,65535,65105,65235,65535,65312,65535,65071,65535,65535,65217,65164,65535,65535,65535,65087,65535,65535,65142,65535,65274,65107,65061,65535,65124,65253,65535,65535,65198,65535,65043,65535,65160,65182,65535,65091,65535,65535,65188,65171,65535,65535,65535,65085,65535,65535,65259,65241,65535,65044,65114,65535,65064,65149,65535,65535,65130,65535,65535,65281,65222,65224,65535,65535,65205,65535,65535,65535,65172,65144,65535,65535,65535,65187,65535,
65535,65242,65112,65535,65054,65093,65258,65535,65131,65535,65535,65079,65535,65535,65535,65148,65206,65535,65535,65272,65535,65535,65535,65223,65179,65535,65535,65535,65104,65535,65535,65197,65250,65535,65050,65123,65102,65535,65535,65273,65535,65139,65535,65535,65535,65072,65163,65535,65535,65213,65070,256,65535,65262,65234,65535,65535,65535,65196,65535,65535,65180,65156,65535,65060,65103,65271,65535,65535,65251,65122,65535,65535,65535,65535,65162,65140,65535,65535,65086,65535,65535,65535,65233,
65214,65535,65535,65069,65535,65098,65267,65535,65535,65245,65118,65046,65535,65096,65192,65535,65195,65175,65535,65535,65232,65535,65535,65229,65209,65535,65535,65535,65066,65535,65535,65158,65134,65535,65535,65535,65246,65535,65535,65117,65099,65057,65535,65263,65176,65535,65535,65153,65535,65535,65535,65191,65535,65210,65277,65535,65535,65535,65227,65535,65535,65135,65081,65535,65535,65535,65157,65535,268,65254,65127,65052,65535,65108,65202,65535,65535,65183,65535,65535,65535,65113,65201,65535,
65218,65535,65535,65078,65266,65535,65535,65238,65143,65535,65535,65535,65075,65535,65535,65167,65109,65062,266,65284,65255,65535,289,65126,65535,65535,65535,65200,65184,65535,271,65168,65535,65535,65237,65535,65535,65219,65076,65535,65535,65535,65166,65535,273,65145,65089,267],ra=[511,0,508,448,494,347,486,482],h=[4,2,3,4,3,4,4,5,4,5,5,6,6,7,7,8,7,8,8,9,9,8,9,9,9,9,9,9,9,9,9,9],P=[4065,4064,4066,4072,14,4069,4068,4074,4081,4067,21,4071,4079,70,4080,4077,4095,4087,4091,25,4093,4084,300,4075,4094,
4086,4090,137,4092,4083,4088,4082],y=[0,4,10,19],t=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,14,15],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,32769,49153,65537],p=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,6,6,8,8,14,14],l=[2,3,4,5,6,7,8,9,10,12,14,16,18,22,26,30,34,42,50,58,66,82,98,114,130,194,258,514,2,2],e=new hi5.DataBuffer(L,0,1),n=hi5.Arrays.arraycopy,f=hi5.Arrays.fill;this.reset=function(){H=
0;L=new Uint8Array(65536);z=Z=0;e=new hi5.DataBuffer(L,0,1)};this.release=function(){L=e=N=null};this.getArrayBuffer=function(){return L.buffer.slice(Z,Z+z)};this.getData=function(){e.setPosition(Z);e.markEnd(Z+z);return e};this.toPDU=function(){var a=new Uint8Array(65576);a[0]=29;a[2]=1;a[3]=2;a[4]=H;a[5]=H>>8;a[6]=H>>16;a[7]=H>>24;a.set(L,8);a.set(new Uint8Array(N.buffer),65544);return a};this.fromStream=function(a){H=a.getLittleEndian32();var d=a.getPosition();L.set(a.getData().subarray(d,d+65536));
a.skipPosition(65536);for(d=0;8>d;d++)N[d]=a.getLittleEndian32()};this.getDecompressedLength=function(){return z};this.dec5=function(a,f,e,m){return D(a,f,e,m)};this.dec=function(d,e,u,m){if(2==(m&15)){var q=L,r=N,k=H,w=0,Q=e,A=0,x=0,C=0;z=0;Z=k;0!=(m&64)&&(n(q,k-32768,q,0,32768),Z=H=k=32768);0!=(m&128)&&(k=0,f(q,0,65536,0),f(r,0,r.length,0),Z=0);if(32!=(m&32))n(d,0,q,k,u),k+=u,z=k-H;else{var I=0;for(var la=e+u;Q<la&&!(C=d[Q++],w|=C<<I,x+=8,I+=8,32<=I););w=v(w);Q<la?(A=v(d[Q++])&255,u=8):u=0;for(;8<=
x;){e=0;for(I=5;13>=I;I++)if(12!=I){C=v(w&4294967295<<32-I);var b=Ca[C&511^C>>>9^C>>>4^C>>>7];0!=(b^C)>>>9?C=b&511:(b=(C>>>8^C&255)>>>2&15,0!=C>>>9&&(b=~b),C=Ca[ra[(b&65535)%12]]);if(I==na[C])break}w<<=I;x-=I;if(256>C)q[k++]=C&255;else if(256<C&&289>C){b=C-257;I=t[b];e=a[b]-1;0!=I&&(e+=v(w&4294967295<<32-I));b=r;var lb=e;var ea=b[2]|b[3]<<16,ea=ea<<16;b[2]=ea&65535;b[3]=ea>>>16&65535;var Ta=b[0]|b[1]<<16,ea=ea|Ta>>>16;b[2]=ea&65535;b[3]=ea>>>16&65535;Ta=Ta<<16|lb;b[0]=Ta&65535;b[1]=Ta>>>16&65535;
w<<=I;x-=I}else if(288<C&&293>C)b=C-289,e=r[b],0!=b&&(I=r,lb=I[0],I[0]=I[b],I[b]=lb);else if(256==C)break;for(I=32-x;0<I;)if(u<I)C=A>>>8-u,w|=C<<32-x-u,x+=u,I-=u,Q<la?(A=v(d[Q++])&255,u=8):u=I=0;else{u>I?(w|=A>>>8-I,A<<=I,A&=255,u-=I,x=32):(w|=A>>>8-I,x=32,Q<la?(A=v(d[Q++])&255,u=8):u=0);break}if(0!=e){for(I=2;9>=I&&(C=v(w&4294967295<<32-I),b=P[C&31^C>>>5^C>>>9],0!=(b^C)>>>5?C=b&31:(C=C>>>4&15,C=P[y[(C^C>>>2^C>>>3)&3]]),I!=h[C]);I++);w<<=I;x-=I;I=p[C];b=l[C];0!=I&&(b+=v(w&4294967295<<32-I));w<<=I;
x-=I;lb=k-e;I=b>e?e:b;for(C=0;0<I;)q[k++]=q[lb++],I--;for(;b>e;)C=C>=e?0:C,q[k++]=q[lb+C++],b--;for(I=32-x;0<I;)if(u<I)C=A>>>8-u,w|=C<<32-x-u,x+=u,I-=u,Q<la?(A=v(d[Q++])&255,u=8):u=I=0;else{u>I?(w|=A>>>8-I,A<<=I,A&=255,u-=I,x=32):(w|=A>>>8-I,x=32,Q<la?(A=v(d[Q++])&255,u=8):u=0);break}}}z=0!=(m&128)?k:k-H}H=k;return 0}return D(d,e,u,m)}}
function Bulk61Data(){var v=0,D=new Uint8Array(2E6),H=0,L=0,N=new hi5.DataBuffer(D,0,1),Z=hi5.Arrays.arraycopy;this.reset=function(){v=0;D=new Uint8Array(2E6);L=H=0;N=new hi5.DataBuffer(D,0,1)};this.release=function(){D=N=null};this.getArrayBuffer=function(){return D.buffer.slice(H,H+L)};this.getData=function(){N.setPosition(H);N.markEnd(H+L);return N};this.toPDU=function(){var z=new Uint8Array(2000008);z[0]=29;z[2]=1;z[3]=9;z[4]=v;z[5]=v>>8;z[6]=v>>16;z[7]=v>>24;z.set(D,8);return z};this.fromStream=
function(z){v=z.getLittleEndian32();var H=z.getPosition();D.set(z.getData().subarray(H,H+2E6))};this.getDecompressedLength=function(){return L};this.dec=function(z,N,Ca,ra){0!=(ra&4)&&(v=0);H=v;L=0;var h=N;if(0==(ra&2)){var P=z[h++]|z[h++]<<8;ra=h+8*P;for(var y=0;y<P;y++){var t=z[h++]|z[h++]<<8,a=z[h++]|z[h++]<<8,p=z[h++]|z[h++]<<8|z[h++]<<16|z[h++]<<24;var l=a-L;Z(z,ra,D,v,l);v+=l;ra+=l;L=a;for(l=0;l<t;l++)D[v++]=D[p++],L++}}else ra=h;if(l=N+Ca-ra)Z(z,ra,D,v,l),L+=l,v+=l;return 0}}
var rdpBitmap=rdpcodecs.bitmap;
function MSGSMEncoder(){function v(b,a){return-32768==b&&-32768==a?32767:b*a>>15<<16>>16}function D(b,a){return-32768==b&&-32768==a?32767:b*a+16384>>15<<16>>16}function H(b,a){if(0>=b){if(0<=a)return b+a;var d=-(b+1)-(a+1);return 2147483647<=d?-2147483648:-d-2}if(0>=a)return b+a;d=b+a;return 2147483647<d?2147483647:d}function L(b){if(0>b){if(-1073741824>=b)return 0;b=~b}return(0!=(b&4294901760)?0!=(b&4278190080)?-1+B[255&b>>24]:7+B[255&b>>16]:0!=(b&65280)?15+B[255&b>>8]:23+B[255&b])<<16>>16}function N(b,
a){return 16<=a?0>b?-1:-0:-16>=a?0:0>a?b<<-a<<16>>16:b>>a<<16>>16}function Z(b,a,d,m,f,e){b=v(b<<16>>16,f[e]);a=b+(a<<16>>16);a=(-32768>a?-32768:32767<a?32767:a)+256;b=(-32768>a?-32768:32767<a?32767:a)>>9<<16>>16;f[e]=(b>d?d-m:b<m?0:b-m)<<16>>16}function z(b,a){var d=la[b+3*a]>>2<<16>>16;return d*d}function na(b,a,d,m,f,e,q){b=b[d]+e;f=((-32768>b?-32768:32767<b?32767:b)<<26>>16)-(f<<17>>16);m=D(q,-32768>f?-32768:32767<f?32767:f);q=m+m;a[d]=-32768>q?-32768:32767<q?32767:q}function Ca(b){for(var a,
d,m=0;8>m;m++)0>b[m]?(a=(-32768==b[m]?32767:-b[m])<<16>>16,d=(a>>2<<16>>16)+26112,b[m]=-(11059>a?a<<1:20070>a?a+11059:-32768>d?-32768:32767<d?32767:d)<<16>>16):(a=b[m],d=(a>>2<<16>>16)+26112,b[m]=(11059>a?a<<1:20070>a?a+11059:-32768>d?-32768:32767<d?32767:d)<<16>>16)}function ra(b,a,d,m,f){for(var e=b.u,q,k,h,l,n,r;0!=d;){d--;q=l=m[f];for(r=0;8>r;r++)h=e[r],n=a[r],e[r]=l,k=D(n,q),l=h+k,l=-32768>l?-32768:32767<l?32767:l,k=D(n,h),q+=k,q=-32768>q?-32768:32767<q?32767:q;m[f++]=q}b.u=e}var h=[6554,16384,
26214,32767],P=[29128,26215,23832,21846,20165,18725,17476,16384],y=[18431,20479,22527,24575,26623,28671,30719,32767],t=new function(){this.dp0=new Int16Array(280);this.mp=this.l_z2=this.z1=0;this.u=new Int16Array(8);this.larpp=[new Int16Array(8),new Int16Array(8)];this.j=0;this.nrp=40;this.v=new Int16Array(9);this.msr=0},a=new Int16Array(8),p=new Int16Array(4),l=new Int16Array(4),e=new Int16Array(4),n=new Int16Array(4),f=new Int16Array(52),d=new Int16Array(160),r=new Uint8Array(33),u=0,m=hi5.Arrays.arraycopy;
this.encode=function(b,B,ea,Ta){for(var lb=B,pa,ya=0;160>ya;ya++)pa=b[lb++],d[ya]=0>pa?32768*pa:32767*pa;q=!q;for(var F=0,Xb=0,W=0,Ba=0,mb=120,ic=new Int16Array(50),G=new Int16Array(160),Jc=0,Qb=0,ec=t.z1,Ib=t.l_z2,J=t.mp,bb,Ub,hb,va,Yb,ga,wa=160;0!=wa;){wa--;va=d[Jc++]>>3<<2<<16>>16;bb=va-ec<<16>>16;ec=va;Yb=bb;Yb<<=15;Ub=Ib>>15<<16>>16;hb=Ib-(Ub<<15)<<16>>16;Yb+=D(hb,32735);ga=32735*Ub;Ib=H(ga,Yb);ga=H(Ib,16384);Ub=D(J,-28180);var J=ga>>15<<16>>16,xa=J+Ub;G[Qb++]=-32768>xa?-32768:32767<xa?32767:
xa}t.z1=ec;t.l_z2=Ib;t.mp=J;var ua,M=0,Zb=0,U;for(U=0;159>=U;U++){var Pb=G[U]+0;var nc=-32768>Pb?-32768:32767<Pb?32767:Pb;nc>Zb&&(Zb=nc)}var Vb=0==Zb?0:4-L(Zb<<16)<<16>>16;if(0<Vb)switch(Vb){case 1:for(U=0;159>=U;U++)G[U]=D(G[U],16384);break;case 2:for(U=0;159>=U;U++)G[U]=D(G[U],8192);break;case 3:for(U=0;159>=U;U++)G[U]=D(G[U],4096);break;case 4:for(U=0;159>=U;U++)G[U]=D(G[U],2048)}var O=G[M];m([0,0,0,0,0,0,0,0,0],0,k,0,k.length);k[0]+=O*G[M-0];O=G[++M];k[0]+=O*G[M-0];k[1]+=O*G[M-1];O=G[++M];k[0]+=
O*G[M-0];k[1]+=O*G[M-1];k[2]+=O*G[M-2];O=G[++M];k[0]+=O*G[M-0];k[1]+=O*G[M-1];k[2]+=O*G[M-2];k[3]+=O*G[M-3];O=G[++M];k[0]+=O*G[M-0];k[1]+=O*G[M-1];k[2]+=O*G[M-2];k[3]+=O*G[M-3];k[4]+=O*G[M-4];O=G[++M];k[0]+=O*G[M-0];k[1]+=O*G[M-1];k[2]+=O*G[M-2];k[3]+=O*G[M-3];k[4]+=O*G[M-4];k[5]+=O*G[M-5];O=G[++M];k[0]+=O*G[M-0];k[1]+=O*G[M-1];k[2]+=O*G[M-2];k[3]+=O*G[M-3];k[4]+=O*G[M-4];k[5]+=O*G[M-5];k[6]+=O*G[M-6];O=G[++M];k[0]+=O*G[M-0];k[1]+=O*G[M-1];k[2]+=O*G[M-2];k[3]+=O*G[M-3];k[4]+=O*G[M-4];k[5]+=O*G[M-
5];k[6]+=O*G[M-6];k[7]+=O*G[M-7];++M;for(ua=M;160>ua;++ua)O=G[ua],k[0]+=O*G[ua-0],k[1]+=O*G[ua-1],k[2]+=O*G[ua-2],k[3]+=O*G[ua-3],k[4]+=O*G[ua-4],k[5]+=O*G[ua-5],k[6]+=O*G[ua-6],k[7]+=O*G[ua-7],k[8]+=O*G[ua-8];for(U=0;9>U;U++)k[U]<<=1;if(0<Vb)for(U=0;160>U;U++)G[U]<<=Vb;var K=new Int16Array(1),ta=0,sa,ka=new Int16Array(9),aa=new Int16Array(9),da=new Int16Array(9);if(0==k[0])for(sa=0;8>sa;sa++)a[sa]=0;else{K[0]=L(k[0]);for(sa=0;8>=sa;sa++)ka[sa]=k[sa]<<K[0]>>16;m(ka,0,da,0,7);m(ka,0,aa,0,8);for(var ba=
1;8>=ba;ba++,ta++){K[0]=aa[1];K[0]=(0>K[0]?-32768==K[0]?32767:-K[0]:K[0])<<16>>16;if(aa[0]<K[0]){for(sa=ba;8>sa;sa++)a[sa]=0;break}var Kb=ta;var Va=K[0],Sa=Va,Jb=aa[0],fc=0,ab=15;if(0==Va)var hc=0;else{for(;0!=ab;)ab--,fc=fc<<17>>16,Sa<<=1,Sa>=Jb&&(Sa-=Jb,fc++);hc=fc<<16>>16}a[Kb]=hc;0<aa[1]&&(a[ta]=-a[ta]);if(8==ba)break;K[0]=D(aa[1],a[ta]);var ja=aa[0]+K[0];aa[0]=-32768>ja?-32768:32767<ja?32767:ja;for(var Ga=1;Ga<=8-ba;Ga++){K[0]=D(da[Ga],a[ta]);var Ha=aa[Ga+1]+K[0];aa[Ga]=-32768>Ha?-32768:32767<
Ha?32767:Ha;K[0]=D(aa[Ga+1],a[ta]);var wb=da[Ga]+K[0];da[Ga]=-32768>wb?-32768:32767<wb?32767:wb}}}for(var Na,zb=0;8>zb;zb++)Na=a[zb],Na=(0>Na?-32768==Na?32767:-Na:Na)<<16>>16,22118>Na?Na>>=1:31130>Na?Na-=11059:(Na-=26112,Na<<=2),a[zb]=0>a[zb]?-Na:Na;var yb=0;Z(20480,0,31,-32,a,yb++);Z(20480,0,31,-32,a,yb++);Z(20480,2048,15,-16,a,yb++);Z(20480,-2560,15,-16,a,yb++);Z(13964,94,7,-8,a,yb++);Z(15360,-1792,7,-8,a,yb++);Z(8534,-341,3,-4,a,yb++);Z(9036,-1144,3,-4,a,yb++);var Ia=new Int16Array(8),vb=t.j;var c=
vb^1;t.j=c;var Ka=t.larpp[vb],xc=t.larpp[c],$b=0;na(a,Ka,$b++,0,0,-32,13107);na(a,Ka,$b++,0,0,-32,13107);na(a,Ka,$b++,0,2048,-16,13107);na(a,Ka,$b++,0,-2560,-16,13107);na(a,Ka,$b++,0,94,-8,19223);na(a,Ka,$b++,0,-1792,-8,17476);na(a,Ka,$b++,0,-341,-4,31454);na(a,Ka,$b++,0,-1144,-4,29708);for(var ac=0;8>ac;ac++){var Sc=(xc[ac]>>2<<16>>16)+(Ka[ac]>>2<<16>>16);Ia[ac]=-32768>Sc?-32768:32767<Sc?32767:Sc;var Tc=Ia[ac]+(xc[ac]>>1<<16>>16);Ia[ac]=-32768>Tc?-32768:32767<Tc?32767:Tc}Ca(Ia);ra(t,Ia,13,G,0);for(var qc=
0;8>qc;qc++){var Uc=(xc[qc]>>1<<16>>16)+(Ka[qc]>>1<<16>>16);Ia[qc]=-32768>Uc?-32768:32767<Uc?32767:Uc}Ca(Ia);ra(t,Ia,14,G,13);for(var bc=0;8>bc;bc++){var Vc=(xc[bc]>>2<<16>>16)+(Ka[bc]>>2<<16>>16);Ia[bc]=-32768>Vc?-32768:32767<Vc?32767:Vc;var Wc=Ia[bc]+(Ka[bc]>>1<<16>>16);Ia[bc]=-32768>Wc?-32768:32767<Wc?32767:Wc}Ca(Ia);ra(t,Ia,13,G,27);for(var yc=0;8>yc;yc++)Ia[yc]=Ka[yc];Ca(Ia);ra(t,Ia,120,G,40);for(var jc=t.dp0,Lb,zc,Xc=0;3>=Xc;Xc++,Xb+=13){for(var ld=G,md=40*Xc,$d=ic,nd=jc,ae=jc,od=mb,pd=p,qd=
e,Yc=W++,ib=void 0,Zc=void 0,rd=void 0,sd=void 0,kc=void 0,cc=void 0,Ac=void 0,R=void 0,td=ld,ud=md,X=nd,S=od,$c=qd,be=pd,Bc=Yc,T=new Int16Array(40),Cc=0,Ua=0;39>=Ua;Ua++)ib=td[Ua+ud],ib=(0>ib?-32768==ib?32767:-ib:ib)<<16>>16,ib>Cc&&(Cc=ib);ib=0;0!=Cc&&(ib=L(Cc<<16));Zc=6<ib?0:6-ib<<16>>16;for(Ua=0;39>=Ua;Ua++)T[Ua]=td[Ua+ud]>>Zc;cc=0;for(R=Ac=40;120>=R;R++){var E=1;var V=T[0]*X[S-R];V+=T[1]*X[E+S-R];E++;V+=T[2]*X[E+S-R];E++;V+=T[3]*X[E+S-R];E++;V+=T[4]*X[E+S-R];E++;V+=T[5]*X[E+S-R];E++;V+=T[6]*X[E+
S-R];E++;V+=T[7]*X[E+S-R];E++;V+=T[8]*X[E+S-R];E++;V+=T[9]*X[E+S-R];E++;V+=T[10]*X[E+S-R];E++;V+=T[11]*X[E+S-R];E++;V+=T[12]*X[E+S-R];E++;V+=T[13]*X[E+S-R];E++;V+=T[14]*X[E+S-R];E++;V+=T[15]*X[E+S-R];E++;V+=T[16]*X[E+S-R];E++;V+=T[17]*X[E+S-R];E++;V+=T[18]*X[E+S-R];E++;V+=T[19]*X[E+S-R];E++;V+=T[20]*X[E+S-R];E++;V+=T[21]*X[E+S-R];E++;V+=T[22]*X[E+S-R];E++;V+=T[23]*X[E+S-R];E++;V+=T[24]*X[E+S-R];E++;V+=T[25]*X[E+S-R];E++;V+=T[26]*X[E+S-R];E++;V+=T[27]*X[E+S-R];E++;V+=T[28]*X[E+S-R];E++;V+=T[29]*X[E+
S-R];E++;V+=T[30]*X[E+S-R];E++;V+=T[31]*X[E+S-R];E++;V+=T[32]*X[E+S-R];E++;V+=T[33]*X[E+S-R];E++;V+=T[34]*X[E+S-R];E++;V+=T[35]*X[E+S-R];E++;V+=T[36]*X[E+S-R];E++;V+=T[37]*X[E+S-R];E++;V+=T[38]*X[E+S-R];E++;V+=T[39]*X[E+S-R];V>cc&&(Ac=R<<16>>16,cc=V)}be[Bc]=Ac;cc=cc<<1>>6-Zc;for(Ua=kc=0;39>=Ua;Ua++){var vd=X[Ua-Ac+S]>>3<<16>>16;kc+=vd*vd}kc<<=1;if(0>=cc)$c[Bc]=0;else if(cc>=kc)$c[Bc]=3;else for(var ib=L(kc),sd=cc<<ib>>16<<16>>16,rd=kc<<ib>>16<<16>>16,Dc=0;2>=Dc&&!(sd<=v(rd,h[Dc]));Dc++)$c[Bc]=Dc;
var La=void 0,fa=void 0,dc=void 0,Wa=pd[Yc],Ec=nd,Fc=ld,Gc=md,Xa=ae,lc=$d,ca=od;switch(qd[Yc]){case 0:dc=3277;for(fa=0;39>=fa;fa++)Xa[fa+ca]=D(dc,Ec[fa-Wa+ca]),La=Fc[fa+Gc]-Xa[fa+ca],lc[fa+5]=-32768>La?-32768:32767<La?32767:La;break;case 1:dc=11469;for(fa=0;39>=fa;fa++)Xa[fa+ca]=D(dc,Ec[fa-Wa+ca]),La=Fc[fa+Gc]-Xa[fa+ca],lc[fa+5]=-32768>La?-32768:32767<La?32767:La;break;case 2:dc=21299;for(fa=0;39>=fa;fa++)Xa[fa+ca]=D(dc,Ec[fa-Wa+ca]),La=Fc[fa+Gc]-Xa[fa+ca],lc[fa+5]=-32768>La?-32768:32767<La?32767:
La;break;case 3:for(dc=32767,fa=0;39>=fa;fa++)Xa[fa+ca]=D(dc,Ec[fa-Wa+ca]),La=Fc[fa+Gc]-Xa[fa+ca],lc[fa+5]=-32768>La?-32768:32767<La?32767:La}for(var mc=ic,ce=n,nb=l,ob=Ba++,Ya=f,qa=Xb,wd=new Int16Array(13),xd=new Int16Array(13),jb=void 0,cb=mc,Pa=0;39>=Pa;Pa++)jb=4096,jb+=-134*cb[Pa+0]+-374*cb[Pa+1]+2054*cb[Pa+3]+5741*cb[Pa+4]+8192*cb[Pa+5]+5741*cb[Pa+6]+2054*cb[Pa+7]+-374*cb[Pa+9]+-134*cb[Pa+10],jb=jb>>13<<16>>16,la[Pa]=-32768>jb?-32768:32767<jb?32767:jb;var rc=void 0,Da=void 0,Y=void 0,pb=wd,sc=
nb,de=ob,Mb=0,rc=Y=0+(z(0,1)+z(0,2)+z(0,3)+z(0,4)+z(0,5)+z(0,6)+z(0,7)+z(0,8)+z(0,9)+z(0,10)+z(0,11)+z(0,12)),Y=Y+z(0,0),Da=Y<<1,Y=0+(z(1,0)+z(1,1)+z(1,2)+z(1,3)+z(1,4)+z(1,5)+z(1,6)+z(1,7)+z(1,8)+z(1,9)+z(1,10)+z(1,11)+z(1,12)),Y=Y<<1;Y>Da&&(Mb=1,Da=Y);Y=0+(z(2,0)+z(2,1)+z(2,2)+z(2,3)+z(2,4)+z(2,5)+z(2,6)+z(2,7)+z(2,8)+z(2,9)+z(2,10)+z(2,11)+z(2,12));Y<<=1;Y>Da&&(Mb=2,Da=Y);Y=rc+z(3,12);Y<<=1;Y>Da&&(Mb=3);for(var Ma=0;12>=Ma;Ma++)pb[Ma]=la[Mb+3*Ma];sc[de]=Mb;for(var za=void 0,Ea=void 0,Nb=void 0,
xb=void 0,yd=void 0,Ab=void 0,ha=void 0,kb=void 0,Bb=void 0,Ob=wd,Cb=Ya,Qa=qa,Rb=ce,qb=ob,Db=0,Ea=0;12>=Ea;Ea++)ha=Ob[Ea],ha=0>ha?-32768==ha?32767:-ha:ha,ha>Db&&(Db=ha);xb=0;ha=Db>>9<<16>>16;for(Ea=Bb=0;5>=Ea;Ea++)Bb=0>=ha?Bb|1:Bb|0,ha=ha>>1<<16>>16,0==Bb&&xb++;var sb=(Db>>(xb+5<<16>>16)<<16>>16)+(xb<<3<<16>>16),kb=-32768>sb?-32768:32767<sb?32767:sb,oa=0;15<kb&&(oa=(kb>>3<<16>>16)-1<<16>>16);za=kb-(oa<<3)<<16>>16;if(0==za)oa=-4,za=7;else{for(;7>=za;)za=(za<<1|1)<<16>>16,oa--;za-=8}I==I?(w=oa,Q=za):
(A=oa,x=za);xb=w;Nb=Q;Ab=6-xb<<16>>16;yd=P[Nb];for(Ea=0;12>=Ea;Ea++)ha=Ob[Ea]<<Ab<<16>>16,ha=v(ha,yd),ha=ha>>12<<16>>16,Cb[Ea+Qa]=ha+4<<16>>16;Q=Nb;w=xb;Rb[qb]=kb;var tb=void 0,db=void 0,Aa=void 0,Sb=void 0,Za=void 0,ia=void 0,eb=Ya,Tb=xd,ub=qa;I==I?(Za=y[Q],db=6-w<<16>>16):(Za=y[x],db=6-A<<16>>16);for(var Sb=-32768>db?-32768:32767<db?32767:db,db=Sb-1,rb=-32768>db?-32768:32767<db?32767:db,Aa=16<=rb?0:-16>=rb?-0:0>rb?N(1,-rb):1<<rb<<16>>16,zd=C=0;13>zd;zd++)ia=(eb[ub++]<<1)-7<<16>>16,ia=ia<<28>>16,
ia=D(Za,ia),tb=ia+Aa,ia=-32768>tb?-32768:32767<tb?32767:tb,Tb[C++]=N(ia,Sb);var Oa=void 0,Hc=xd,$a=mc,Ad=I,Eb=13,Fb=0,Oa=Ad==I?5:0;switch(nb[ob]){case 3:$a[Oa++]=0;do $a[Oa++]=0,$a[Oa++]=0,$a[Oa++]=Hc[Fb++],--Eb;while(0!=Eb);break;case 2:do $a[Oa++]=0,$a[Oa++]=0,$a[Oa++]=Hc[Fb++],--Eb;while(0!=Eb);break;case 1:do $a[Oa++]=0,$a[Oa++]=Hc[Fb++],$a[Oa++]=0,--Eb;while(0!=Eb);break;case 0:do $a[Oa++]=Hc[Fb++],$a[Oa++]=0,$a[Oa++]=0,--Eb;while(0!=Eb)}Ad==I&&($a[Oa++]=0);for(Lb=0;39>=Lb;Lb++)zc=ic[5+Lb]+jc[Lb+
mb],jc[Lb+mb]=-32768>zc?-32768:32767<zc?32767:zc;mb+=40}for(Lb=0;120>Lb;Lb++)jc[Lb]=jc[160+Lb];if(q){var g=a[0]<<4|a[1]<<10;r[F++]=g>>4;g=g>>5|a[2]<<11;r[F++]=g>>7;g=g>>5|a[3]<<11;g=g>>4|a[4]<<12;r[F++]=g>>6;g=g>>4|a[5]<<12;g=g>>3|a[6]<<13;r[F++]=g>>7;g=g>>3|a[7]<<13;g=g>>7|p[0]<<9;r[F++]=g>>5;g=g>>2|e[0]<<14;g=g>>2|l[0]<<14;g=g>>6|n[0]<<10;r[F++]=g>>3;g=g>>3|f[0]<<13;r[F++]=g>>8;g=g>>3|f[1]<<13;g=g>>3|f[2]<<13;g=g>>3|f[3]<<13;r[F++]=g>>7;g=g>>3|f[4]<<13;g=g>>3|f[5]<<13;g=g>>3|f[6]<<13;r[F++]=g>>
6;g=g>>3|f[7]<<13;g=g>>3|f[8]<<13;r[F++]=g>>8;g=g>>3|f[9]<<13;g=g>>3|f[10]<<13;g=g>>3|f[11]<<13;r[F++]=g>>7;g=g>>3|f[12]<<13;g=g>>7|p[1]<<9;r[F++]=g>>5;g=g>>2|e[1]<<14;g=g>>2|l[1]<<14;g=g>>6|n[1]<<10;r[F++]=g>>3;g=g>>3|f[13]<<13;r[F++]=g>>8;g=g>>3|f[14]<<13;g=g>>3|f[15]<<13;g=g>>3|f[16]<<13;r[F++]=g>>7;g=g>>3|f[17]<<13;g=g>>3|f[18]<<13;g=g>>3|f[19]<<13;r[F++]=g>>6;g=g>>3|f[20]<<13;g=g>>3|f[21]<<13;r[F++]=g>>8;g=g>>3|f[22]<<13;g=g>>3|f[23]<<13;g=g>>3|f[24]<<13;r[F++]=g>>7;g=g>>3|f[25]<<13;g=g>>7|p[2]<<
9;r[F++]=g>>5;g=g>>2|e[2]<<14;g=g>>2|l[2]<<14;g=g>>6|n[2]<<10;r[F++]=g>>3;g=g>>3|f[26]<<13;r[F++]=g>>8;g=g>>3|f[27]<<13;g=g>>3|f[28]<<13;g=g>>3|f[29]<<13;r[F++]=g>>7;g=g>>3|f[30]<<13;g=g>>3|f[31]<<13;g=g>>3|f[32]<<13;r[F++]=g>>6;g=g>>3|f[33]<<13;g=g>>3|f[34]<<13;r[F++]=g>>8;g=g>>3|f[35]<<13;g=g>>3|f[36]<<13;g=g>>3|f[37]<<13;r[F++]=g>>7;g=g>>3|f[38]<<13;g=g>>7|p[3]<<9;r[F++]=g>>5;g=g>>2|e[3]<<14;g=g>>2|l[3]<<14;g=g>>6|n[3]<<10;r[F++]=g>>3;g=g>>3|f[39]<<13;r[F++]=g>>8;g=g>>3|f[40]<<13;g=g>>3|f[41]<<
13;g=g>>3|f[42]<<13;r[F++]=g>>7;g=g>>3|f[43]<<13;g=g>>3|f[44]<<13;g=g>>3|f[45]<<13;r[F++]=g>>6;g=g>>3|f[46]<<13;g=g>>3|f[47]<<13;r[F++]=g>>8;g=g>>3|f[48]<<13;g=g>>3|f[49]<<13;g=g>>3|f[50]<<13;r[F++]=g>>7;g=g>>3|f[51]<<13;r[F]=g>>12;u=r[F]}else g=u<<6|a[0]<<10,r[F++]=g>>6,g=g>>6|a[1]<<10,r[F++]=g>>8,g=g>>5|a[2]<<11,g=g>>5|a[3]<<11,r[F++]=g>>6,g=g>>4|a[4]<<12,g=g>>4|a[5]<<12,r[F++]=g>>6,g=g>>3|a[6]<<13,g=g>>3|a[7]<<13,r[F++]=g>>8,g=g>>7|p[0]<<9,g=g>>2|e[0]<<14,r[F++]=g>>7,g=g>>2|l[0]<<14,g=g>>6|n[0]<<
10,r[F++]=g>>7,g=g>>3|f[0]<<13,g=g>>3|f[1]<<13,g=g>>3|f[2]<<13,r[F++]=g>>6,g=g>>3|f[3]<<13,g=g>>3|f[4]<<13,r[F++]=g>>8,g=g>>3|f[5]<<13,g=g>>3|f[6]<<13,g=g>>3|f[7]<<13,r[F++]=g>>7,g=g>>3|f[8]<<13,g=g>>3|f[9]<<13,g=g>>3|f[10]<<13,r[F++]=g>>6,g=g>>3|f[11]<<13,g=g>>3|f[12]<<13,r[F++]=g>>8,g=g>>7|p[1]<<9,g=g>>2|e[1]<<14,r[F++]=g>>7,g=g>>2|l[1]<<14,g=g>>6|n[1]<<10,r[F++]=g>>7,g=g>>3|f[13]<<13,g=g>>3|f[14]<<13,g=g>>3|f[15]<<13,r[F++]=g>>6,g=g>>3|f[16]<<13,g=g>>3|f[17]<<13,r[F++]=g>>8,g=g>>3|f[18]<<13,g=
g>>3|f[19]<<13,g=g>>3|f[20]<<13,r[F++]=g>>7,g=g>>3|f[21]<<13,g=g>>3|f[22]<<13,g=g>>3|f[23]<<13,r[F++]=g>>6,g=g>>3|f[24]<<13,g=g>>3|f[25]<<13,r[F++]=g>>8,g=g>>7|p[2]<<9,g=g>>2|e[2]<<14,r[F++]=g>>7,g=g>>2|l[2]<<14,g=g>>6|n[2]<<10,r[F++]=g>>7,g=g>>3|f[26]<<13,g=g>>3|f[27]<<13,g=g>>3|f[28]<<13,r[F++]=g>>6,g=g>>3|f[29]<<13,g=g>>3|f[30]<<13,r[F++]=g>>8,g=g>>3|f[31]<<13,g=g>>3|f[32]<<13,g=g>>3|f[33]<<13,r[F++]=g>>7,g=g>>3|f[34]<<13,g=g>>3|f[35]<<13,g=g>>3|f[36]<<13,r[F++]=g>>6,g=g>>3|f[37]<<13,g=g>>3|f[38]<<
13,r[F++]=g>>8,g=g>>7|p[3]<<9,g=g>>2|e[3]<<14,r[F++]=g>>7,g=g>>2|l[3]<<14,g=g>>6|n[3]<<10,r[F++]=g>>7,g=g>>3|f[39]<<13,g=g>>3|f[40]<<13,g=g>>3|f[41]<<13,r[F++]=g>>6,g=g>>3|f[42]<<13,g=g>>3|f[43]<<13,r[F++]=g>>8,g=g>>3|f[44]<<13,g=g>>3|f[45]<<13,g=g>>3|f[46]<<13,r[F++]=g>>7,g=g>>3|f[47]<<13,g=g>>3|f[48]<<13,g=g>>3|f[49]<<13,r[F++]=g>>6,g=g>>3|f[50]<<13,g=g>>3|f[51]<<13,r[F++]=g>>8;var Gb,Bd=q?32:33;for(Gb=0;Gb<Bd;Gb++)ea[Gb+Ta]=r[Gb];return Bd};var q=!1,B=[8,7,6,6,5,5,5,5,4,4,4,4,4,4,4,4,3,3,3,3,3,
3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],k=new Int32Array(9),w=0,Q=0,A=
0,x=0,C=0,I=0,la=new Int16Array(40)}
function MSGSM(){function v(a,e,l,k,w,v,A,x){var m=0;f(d,0,160,0);f(r,0,40,0);for(var q=0;3>=q;q++,m+=13){var la=w[q],b=l[q],B=m,Q=v,Z=r,Ra=new Int32Array(13);Ra.buffer||f(Ra,0,13,0);var pa=0;15<la&&(pa=(la>>3)-1);la-=pa<<3;if(0==la)pa=-4,la=7;else{for(;7>=la;)la=la<<1|1,pa--;la-=8}var ya=Array(2);ya[0]=pa;ya[1]=la;var pa=Ra,la=B,B=Ca[ya[1]];ya=z(6,ya[0]);var F=z(ya,1);F=16<=F?0:-16>=F?-0:0>F?na(1,-F):1<<F;for(var Xb=0,W=0;13>W;W++){var Ba=(Q[la++]<<1)-7;Ba<<=12;Ba=N(B,Ba);Ba+=F;-32768>Ba?Ba=-32768:
32767<Ba&&(Ba=32767);pa[Xb++]=na(Ba,ya)}Q=13;B=pa=0;switch(b){case 3:Z[B++]=0;case 2:Z[B++]=0;case 1:Z[B++]=0;case 0:Z[B++]=Ra[pa++],Q--}do Z[B++]=0,Z[B++]=0,Z[B++]=Ra[pa++];while(0<--Q);for(;4>++b;)Z[B++]=0;Ra=e[q];b=k[q];Z=r;t=Ra=40>Ra||120<Ra?t:Ra;Q=ra[b];for(pa=0;39>=pa;pa++)b=N(Q,h[pa-Ra+120]),b+=Z[pa],-32768>b?b=-32768:32767<b&&(b=32767),h[pa+120]=b;n(h,40,h,0,120);n(h,120,d,40*q,39)}e=P[y];l=P[y^=1];k=0;D(a,e,k++,0,0,-32,13107);D(a,e,k++,0,0,-32,13107);D(a,e,k++,0,2048,-16,13107);D(a,e,k++,
0,-2560,-16,13107);D(a,e,k++,0,94,-8,19223);D(a,e,k++,0,-1792,-8,17476);D(a,e,k++,0,-341,-4,31454);D(a,e,k++,0,-1144,-4,29708);a=u;for(w=0;8>w;w++)k=(l[w]>>2)+(e[w]>>2),-32768>k?k=-32768:32767<k&&(k=32767),k+=l[w]>>1,-32768>k?k=-32768:32767<k&&(k=32767),a[w]=k;H(u);L(u,13,d,A,0,x);a=u;for(w=0;8>w;w++)k=(l[w]>>1)+(e[w]>>1),-32768>k?k=-32768:32767<k&&(k=32767),a[w]=k;H(u);L(u,14,d,A,13,x);a=u;for(w=0;8>w;w++)k=(l[w]>>2)+(e[w]>>2),-32768>k?k=-32768:32767<k&&(k=32767),k+=e[w]>>1,-32768>k?k=-32768:32767<
k&&(k=32767),a[w]=k;H(u);L(u,13,d,A,27,x);a=u;for(l=0;8>l;l++)a[l]=e[l];H(u);L(u,120,d,A,40,x);e=x;for(l=x+160;l-- >x;e++)a=N(p,28180),p=A[e]+a,-32768>p?p=-32768:32767<p&&(p=32767),a=p<<1,-32768>a?a=-32768:32767<a&&(a=32767),A[e]=a}function D(a,d,f,e,h,l,n){e=a[f]+l;-32768>e?e=-32768:32767<e&&(e=32767);e=z(e<<10,h<<1);e=N(n,e);e+=e;-32768>e?e=-32768:32767<e&&(e=32767);d[f]=e}function H(a){for(var d,e=0;8>e;e++)0>a[e]?(d=-32768==a[e]?32767:-a[e],a[e]=-(11059>d?d<<1:20070>d?d+11059:Z(d>>2,26112))):
(d=a[e],a[e]=11059>d?d<<1:20070>d?d+11059:Z(d>>2,26112))}function L(d,e,f,h,l,n){for(var m,q,k;0!=e;){e--;m=f[l];for(var r=7;0<=r;r--)q=d[r],k=a[r],k=((-32768==q&&-32768==k?32767:65535&q*k+16384>>15)&65535)<<16>>16,m=z(m,k),q=((-32768==q&&-32768==m?32767:65535&q*m+16384>>15)&65535)<<16>>16,q=a[r]+q,-32768>q?q=-32768:32767<q&&(q=32767),a[r+1]=q;h[n+l++]=a[0]=m}}function N(a,d){return-32768==a&&-32768==d?32767:(a*d+16384>>15&65535)<<16>>16}function Z(a,d){var e=a+d;return-32768>e?-32768:32767<e?32767:
e}function z(a,d){var e=a-d;return-32768>e?-32768:32767<e?32767:e}function na(a,d){return 16<=d?0>a?-1:0:-16>=d?0:0>d?a<<-d:a>>d}var Ca=[18431,20479,22527,24575,26623,28671,30719,32767],ra=[3277,11469,21299,32767],h=new Int32Array(280),P=[new Int32Array(8),new Int32Array(8)],y=0,t=40,a=new Int32Array(9),p=0,l=new Int32Array(320);l[0]=0;var e=[.1],n=hi5.Arrays.arraycopy,f=hi5.Arrays.fill;this.decode=function(a,d,f){var h=0,m;f=d+f;for(var n=new Int32Array(8),q=new Int32Array(4),r=new Int32Array(4),
t=new Int32Array(4),u=new Int32Array(4),p=new Int32Array(52);d<f;){var b=a[d++]&255;n[0]=b&63;b>>>=6;b|=a[d++]<<2&1023;n[1]=b&63;b>>>=6;b|=a[d++]<<4&4095;n[2]=b&31;b>>>=5;n[3]=b&31;b>>>=5;b|=a[d++]<<2&1023;n[4]=b&15;b>>>=4;n[5]=b&15;b>>>=4;b|=a[d++]<<2&1023;n[6]=b&7;b>>>=3;n[7]=b&7;b>>>=3;b|=a[d++]<<4&4095;q[0]=b&127;b>>>=7;t[0]=b&3;b>>>=2;r[0]=b&3;b>>>=2;b|=a[d++]<<1&511;u[0]=b&63;b>>>=6;p[0]=b&7;b=a[d++]&255;p[1]=b&7;b>>>=3;p[2]=b&7;b>>>=3;b|=a[d++]<<2&1023;p[3]=b&7;b>>>=3;p[4]=b&7;b>>>=3;p[5]=
b&7;b>>>=3;b|=a[d++]<<1&511;p[6]=b&7;b>>>=3;p[7]=b&7;b>>>=3;p[8]=b&7;b=a[d++]&255;p[9]=b&7;b>>>=3;p[10]=b&7;b>>>=3;b|=a[d++]<<2&1023;p[11]=b&7;b>>>=3;p[12]=b&7;b>>>=3;b|=a[d++]<<4&4095;q[1]=b&127;b>>>=7;t[1]=b&3;b>>>=2;r[1]=b&3;b>>>=2;b|=a[d++]<<1&511;u[1]=b&63;b>>>=6;p[13]=b&7;b=a[d++]&255;p[14]=b&7;b>>>=3;p[15]=b&7;b>>>=3;b|=a[d++]<<2&1023;p[16]=b&7;b>>>=3;p[17]=b&7;b>>>=3;p[18]=b&7;b>>>=3;b|=a[d++]<<1&511;p[19]=b&7;b>>>=3;p[20]=b&7;b>>>=3;p[21]=b&7;b=a[d++]&255;p[22]=b&7;b>>>=3;p[23]=b&7;b>>>=
3;b|=a[d++]<<2&1023;p[24]=b&7;b>>>=3;p[25]=b&7;b>>>=3;b|=a[d++]<<4&4095;q[2]=b&127;b>>>=7;t[2]=b&3;b>>>=2;r[2]=b&3;b>>>=2;b|=a[d++]<<1&511;u[2]=b&63;b>>>=6;p[26]=b&7;b=a[d++]&255;p[27]=b&7;b>>>=3;p[28]=b&7;b>>>=3;b|=a[d++]<<2&1023;p[29]=b&7;b>>>=3;p[30]=b&7;b>>>=3;p[31]=b&7;b>>>=3;b|=a[d++]<<1&511;p[32]=b&7;b>>>=3;p[33]=b&7;b>>>=3;p[34]=b&7;b=a[d++]&255;p[35]=b&7;b>>>=3;p[36]=b&7;b>>>=3;b|=a[d++]<<2&1023;p[37]=b&7;b>>>=3;p[38]=b&7;b>>>=3;b|=a[d++]<<4&4095;q[3]=b&127;b>>>=7;t[3]=b&3;b>>>=2;r[3]=b&
3;b>>>=2;b|=a[d++]<<1&511;u[3]=b&63;b>>>=6;p[39]=b&7;b=a[d++]&255;p[40]=b&7;b>>>=3;p[41]=b&7;b>>>=3;b|=a[d++]<<2&1023;p[42]=b&7;b>>>=3;p[43]=b&7;b>>>=3;p[44]=b&7;b>>>=3;b|=a[d++]<<1&511;p[45]=b&7;b>>>=3;p[46]=b&7;b>>>=3;p[47]=b&7;b=a[d++]&255;p[48]=b&7;b>>>=3;p[49]=b&7;b>>>=3;b|=a[d++]<<2&1023;p[50]=b&7;b>>>=3;p[51]=b&7;b>>>=3;v(n,q,r,t,u,p,l,0);b&=15;b|=a[d++]<<4&4095;n[0]=b&63;b>>>=6;n[1]=b&63;b=a[d++]&255;n[2]=b&31;b>>>=5;b|=a[d++]<<3&2047;n[3]=b&31;b>>>=5;n[4]=b&15;b>>>=4;b|=a[d++]<<2&1023;n[5]=
b&15;b>>>=4;n[6]=b&7;b>>>=3;n[7]=b&7;b=a[d++]&255;q[0]=b&127;b>>>=7;b|=a[d++]<<1&511;t[0]=b&3;b>>>=2;r[0]=b&3;b>>>=2;b|=a[d++]<<5&8191;u[0]=b&63;b>>>=6;p[0]=b&7;b>>>=3;p[1]=b&7;b>>>=3;b|=a[d++]<<1&511;p[2]=b&7;b>>>=3;p[3]=b&7;b>>>=3;p[4]=b&7;b=a[d++]&255;p[5]=b&7;b>>>=3;p[6]=b&7;b>>>=3;b|=a[d++]<<2&1023;p[7]=b&7;b>>>=3;p[8]=b&7;b>>>=3;p[9]=b&7;b>>>=3;b|=a[d++]<<1&511;p[10]=b&7;b>>>=3;p[11]=b&7;b>>>=3;p[12]=b&7;b=a[d++]&255;q[1]=b&127;b>>>=7;b|=a[d++]<<1&511;t[1]=b&3;b>>>=2;r[1]=b&3;b>>>=2;b|=a[d++]<<
5&8191;u[1]=b&63;b>>>=6;p[13]=b&7;b>>>=3;p[14]=b&7;b>>>=3;b|=a[d++]<<1&511;p[15]=b&7;b>>>=3;p[16]=b&7;b>>>=3;p[17]=b&7;b=a[d++]&255;p[18]=b&7;b>>>=3;p[19]=b&7;b>>>=3;b|=a[d++]<<2&1023;p[20]=b&7;b>>>=3;p[21]=b&7;b>>>=3;p[22]=b&7;b>>>=3;b|=a[d++]<<1&511;p[23]=b&7;b>>>=3;p[24]=b&7;b>>>=3;p[25]=b&7;b=a[d++]&255;q[2]=b&127;b>>>=7;b|=a[d++]<<1&511;t[2]=b&3;b>>>=2;r[2]=b&3;b>>>=2;b|=a[d++]<<5&8191;u[2]=b&63;b>>>=6;p[26]=b&7;b>>>=3;p[27]=b&7;b>>>=3;b|=a[d++]<<1&511;p[28]=b&7;b>>>=3;p[29]=b&7;b>>>=3;p[30]=
b&7;b=a[d++]&255;p[31]=b&7;b>>>=3;p[32]=b&7;b>>>=3;b|=a[d++]<<2&1023;p[33]=b&7;b>>>=3;p[34]=b&7;b>>>=3;p[35]=b&7;b>>>=3;b|=a[d++]<<1&511;p[36]=b&7;b>>>=3;p[37]=b&7;b>>>=3;p[38]=b&7;b=a[d++]&255;q[3]=b&127;b>>>=7;b|=a[d++]<<1&511;t[3]=b&3;b>>>=2;r[3]=b&3;b>>>=2;b|=a[d++]<<5&8191;u[3]=b&63;b>>>=6;p[39]=b&7;b>>>=3;p[40]=b&7;b>>>=3;b|=a[d++]<<1&511;p[41]=b&7;b>>>=3;p[42]=b&7;b>>>=3;p[43]=b&7;b=a[d++]&255;p[44]=b&7;b>>>=3;p[45]=b&7;b>>>=3;b|=a[d++]<<2&1023;p[46]=b&7;b>>>=3;p[47]=b&7;b>>>=3;p[48]=b&7;b>>>=
3;b|=a[d++]<<1&511;p[49]=b&7;b>>>=3;p[50]=b&7;b>>>=3;p[51]=b&7;v(n,q,r,t,u,p,l,160);b=320*h++;for(m=0;320>m;m++)e[b++]=l[m]/32768}e.length=320*h;return e};var d=new Int32Array(160),r=new Int32Array(40),u=new Int32Array(8)};
